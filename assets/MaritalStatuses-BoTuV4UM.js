import{_ as F,u as G,r as d,A as L,i as j,c as u,a,d as i,b as w,k as o,v as M,h as T,F as S,n as H,l as K,t as v,e as q,T as Q,j as f,o as r,x as R,w as z,m as $}from"./index-Mv3MxCR1.js";import{S as h}from"./sweetalert2.esm.all-BQxta0Da.js";import{S as D}from"./search-DW_529iS.js";import{P as N}from"./plus-BF4bXWAK.js";import{C as X}from"./chevron-left-C_DfDUMJ.js";import{C as Y}from"./chevron-right-u8dkcCrv.js";import{P as A,T as J}from"./trash-2-CXOSxmzs.js";import{X as O,C as W}from"./x-D8hPaNXE.js";import{T as Z}from"./type-zrf9LQ7g.js";import"./createLucideIcon-DBeZuCHW.js";const aa={class:"master-data-page"},ta={class:"header-section"},ea={class:"header-actions"},sa={class:"search-wrapper"},la=["disabled"],na=["disabled"],oa={class:"card table-card"},ia={key:0,class:"loading-state"},ra={key:1,class:"empty-state"},da={class:"empty-icon"},ua={key:2,class:"table-container"},ca={class:"modern-table"},pa={class:"order-badge"},va={class:"font-bold text-dark"},ma={class:"actions-group"},ha=["onClick","disabled"],ba=["onClick","disabled"],_a={class:"pagination-footer"},fa={class:"per-page-selector"},ga=["disabled"],ka={class:"pagination-controls"},ya={class:"page-info"},Ca={class:"page-buttons"},wa=["disabled"],Sa=["disabled"],xa={class:"modal-content"},Ba={class:"modal-header"},Ma={class:"header-icon"},Ta={class:"header-text"},za=["disabled"],$a={class:"form-section"},Da={class:"form-group full-width"},Na={class:"input-wrapper"},Aa=["disabled"],Pa={class:"modal-footer"},Ua=["disabled"],Va=["disabled"],Ea={__name:"MaritalStatuses",setup(Ia){const b=G(),g=d([]),k=d(!0),s=d(!1),y=d(!1),c=d(null),C=d(""),x=d(null),l=d({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0}),m=d({name:"",branch_id:null}),p=async(n=1)=>{if(b.activeBranch){k.value=!0;try{const t=await f.get("/marital-statuses",{params:{branch_id:b.activeBranch.id,page:n,per_page:l.value.per_page,search:C.value}});g.value=t.data.data,l.value={current_page:t.data.current_page,last_page:t.data.last_page,per_page:t.data.per_page,total:t.data.total,from:t.data.from,to:t.data.to}}catch(t){console.error("Failed to fetch marital statuses",t),h.fire("Error","Gagal memuat data status pernikahan.","error")}finally{k.value=!1}}},P=()=>{clearTimeout(x.value),x.value=setTimeout(()=>{p(1)},500)};L(()=>b.activeBranch,n=>{n&&p(1)},{immediate:!0}),j(()=>{p()});const B=(n=null)=>{n?(c.value=n.id,m.value={name:n.name,branch_id:n.branch_id}):(c.value=null,m.value={name:"",branch_id:b.activeBranch?.id}),y.value=!0},_=()=>{y.value=!1},U=async()=>{if(!m.value.branch_id){h.fire("Error","Silakan pilih cabang terlebih dahulu.","error");return}s.value=!0;try{c.value?await f.put(`/marital-statuses/${c.value}`,m.value):await f.post("/marital-statuses",m.value),await p(l.value.current_page),_(),h.fire({icon:"success",title:"Berhasil!",text:"Data status pernikahan telah diperbarui.",timer:2e3,showConfirmButton:!1})}catch{h.fire("Error","Gagal menyimpan data.","error")}finally{s.value=!1}},V=async n=>{if((await h.fire({title:"Apakah Anda yakin?",text:`Status "${n.name}" akan dihapus permanen!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed)try{await f.delete(`/marital-statuses/${n.id}`),await p(l.value.current_page),h.fire("Dihapus!","Data telah berhasil dihapus.","success")}catch{h.fire("Error","Gagal menghapus data.","error")}};return(n,t)=>(r(),u("div",aa,[a("div",ta,[t[10]||(t[10]=a("div",{class:"title-group"},[a("h1",{class:"page-title"},"Master Status Pernikahan"),a("p",{class:"page-subtitle"},"Kelola daftar status pernikahan untuk jemaat di cabang ini")],-1)),a("div",ea,[a("div",sa,[i(o(D),{size:"18",class:"search-icon"}),w(a("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>C.value=e),type:"text",placeholder:"Cari status...",class:"search-input",onInput:P,disabled:s.value},null,40,la),[[M,C.value]])]),a("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=e=>B()),disabled:s.value},[i(o(N),{size:"18"}),t[8]||(t[8]=T()),t[9]||(t[9]=a("span",null,"Tambah Status",-1))],8,na)])]),a("div",oa,[k.value?(r(),u("div",ia,[...t[11]||(t[11]=[a("div",{class:"spinner"},null,-1),a("p",null,"Memuat data...",-1)])])):g.value.length===0?(r(),u("div",ra,[a("div",da,[i(o(D),{size:"48"})]),t[12]||(t[12]=a("p",null,"Tidak ada data yang ditemukan.",-1))])):(r(),u("div",ua,[a("table",ca,[t[13]||(t[13]=a("thead",null,[a("tr",null,[a("th",{style:{width:"80px"}},"No"),a("th",null,"Nama Status"),a("th",{class:"text-right"},"Aksi")])],-1)),a("tbody",null,[(r(!0),u(S,null,H(g.value,(e,E)=>(r(),u("tr",{key:e.id,class:"row-hover"},[a("td",null,[a("span",pa,v(l.value.from+E),1)]),a("td",va,v(e.name),1),a("td",null,[a("div",ma,[a("button",{class:"action-btn edit",onClick:I=>B(e),title:"Ubah",disabled:s.value},[i(o(A),{size:"16"})],8,ha),a("button",{class:"action-btn delete",onClick:I=>V(e),title:"Hapus",disabled:s.value},[i(o(J),{size:"16"})],8,ba)])])]))),128))])]),a("div",_a,[a("div",fa,[t[15]||(t[15]=a("span",{class:"text-xs font-bold text-muted"},"TAMPILKAN",-1)),w(a("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>l.value.per_page=e),onChange:t[3]||(t[3]=e=>p(1)),disabled:s.value},[...t[14]||(t[14]=[a("option",{value:10},"10 data",-1),a("option",{value:25},"25 data",-1),a("option",{value:50},"50 data",-1),a("option",{value:100},"100 data",-1)])],40,ga),[[K,l.value.per_page]])]),a("div",ka,[a("span",ya,[a("b",null,v(l.value.from||0)+"-"+v(l.value.to||0),1),t[16]||(t[16]=T(" dari ",-1)),a("b",null,v(l.value.total),1)]),a("div",Ca,[a("button",{class:"page-btn",disabled:l.value.current_page===1||s.value,onClick:t[4]||(t[4]=e=>p(l.value.current_page-1))},[i(o(X),{size:"18"})],8,wa),a("button",{class:"page-btn",disabled:l.value.current_page===l.value.last_page||s.value,onClick:t[5]||(t[5]=e=>p(l.value.current_page+1))},[i(o(Y),{size:"18"})],8,Sa)])])])]))]),i(Q,{name:"modal-fade"},{default:q(()=>[y.value?(r(),u("div",{key:0,class:"modal-overlay",onClick:t[7]||(t[7]=z(e=>!s.value&&_(),["self"]))},[a("div",xa,[a("div",Ba,[a("div",Ma,[c.value?(r(),$(o(A),{key:1,size:"24"})):(r(),$(o(N),{key:0,size:"24"}))]),a("div",Ta,[a("h2",null,v(c.value?"Update Status":"Tambah Status Baru"),1),a("p",null,v(c.value?"Ubah informasi status pernikahan yang sudah ada":"Masukkan nama status pernikahan baru"),1)]),a("button",{class:"close-btn",onClick:_,disabled:s.value},[i(o(O),{size:"20"})],8,za)]),a("form",{onSubmit:z(U,["prevent"]),class:"modal-body"},[a("div",$a,[a("div",Da,[t[17]||(t[17]=a("label",{class:"form-label"},"Nama Status Pernikahan",-1)),a("div",Na,[i(o(Z),{size:"18",class:"input-icon"}),w(a("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>m.value.name=e),type:"text",required:"",placeholder:"Contoh: Belum Menikah, Menikah, dll.",disabled:s.value},null,8,Aa),[[M,m.value.name]])])])]),a("div",Pa,[a("button",{type:"button",class:"btn btn-ghost",onClick:_,disabled:s.value},"Batal",8,Ua),a("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:s.value},[s.value?(r(),u(S,{key:0},[t[18]||(t[18]=a("div",{class:"spinner small"},null,-1)),t[19]||(t[19]=a("span",null,"Menyimpan...",-1))],64)):(r(),u(S,{key:1},[i(o(W),{size:"18"}),a("span",null,v(c.value?"Update Status":"Simpan Status"),1)],64))],8,Va)])],32)])])):R("",!0)]),_:1})]))}},Ya=F(Ea,[["__scopeId","data-v-7b03e816"]]);export{Ya as default};
