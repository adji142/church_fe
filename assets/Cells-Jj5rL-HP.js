import{_ as G,u as W,r as v,A as F,i as j,c as r,a,d as o,b as c,k as i,v as b,h as $,F as g,n as C,l as w,t as n,e as Q,T as X,j as y,o as d,q as T,x as Y,w as P,m as J}from"./index-Mv3MxCR1.js";import{S as f}from"./sweetalert2.esm.all-BQxta0Da.js";import{S as D}from"./search-DW_529iS.js";import{P as L}from"./plus-BF4bXWAK.js";import{C as O}from"./chevron-left-C_DfDUMJ.js";import{C as Z}from"./chevron-right-u8dkcCrv.js";import{C as V}from"./clock-Cw4-8-Ua.js";import{P as E,T as aa}from"./trash-2-CXOSxmzs.js";import{X as ta,C as sa}from"./x-D8hPaNXE.js";import{H as ea}from"./hash-3C7pK2I6.js";import{U as la}from"./users-D_w7s7_7.js";import{L as ia}from"./layers-ChaLHLIF.js";import{M as oa}from"./map-pin-DIz-n_0r.js";import{N as na}from"./navigation-BWtfBrq5.js";import{C as da}from"./calendar-COvuOzBD.js";import{C as ra}from"./calendar-range-BxVLNI6C.js";import"./createLucideIcon-DBeZuCHW.js";const ua={class:"master-data-page wide"},pa={class:"header-section"},ca={class:"header-actions"},va={class:"search-wrapper"},ma=["disabled"],_a=["disabled"],ba={class:"card table-card"},fa={key:0,class:"loading-state"},ha={key:1,class:"empty-state"},ga={class:"empty-icon"},ya={key:2,class:"table-container"},ka={class:"modern-table"},Ca={class:"code-badge"},wa={class:"name-column"},xa={class:"font-bold text-dark"},za={class:"text-xs text-muted"},Ba={class:"type-tag"},Sa={class:"schedule-column"},Ua={class:"text-sm font-bold"},Ka={key:0,class:"time-range-display"},Ma={key:1,class:"text-xs text-muted italic"},Ta={class:"actions-group"},Va=["onClick","disabled"],Aa=["onClick","disabled"],Na={class:"pagination-footer"},$a={class:"per-page-selector"},Pa=["disabled"],Ja={class:"pagination-controls"},Da={class:"page-info"},La={class:"page-buttons"},Ea=["disabled"],Ha=["disabled"],Ia={class:"modal-content large"},Ra={class:"modal-header"},qa={class:"header-icon"},Ga={class:"header-text"},Wa=["disabled"],Fa={class:"form-grid"},ja={class:"form-group"},Qa={class:"input-wrapper"},Xa=["disabled"],Ya={class:"form-group"},Oa={class:"input-wrapper"},Za=["disabled"],at={class:"form-group"},tt={class:"input-wrapper"},st=["disabled"],et=["value"],lt={class:"form-group"},it={class:"input-wrapper"},ot=["disabled"],nt=["value"],dt={class:"form-group full-width"},rt={class:"input-wrapper"},ut=["disabled"],pt={class:"form-group"},ct={class:"input-wrapper"},vt=["disabled"],mt=["value"],_t={class:"form-group"},bt={class:"input-wrapper"},ft=["disabled"],ht={class:"form-group"},gt={class:"input-wrapper"},yt=["disabled"],kt={class:"form-group"},Ct={class:"input-wrapper"},wt=["disabled"],xt={class:"form-group"},zt={class:"status-toggle-group"},Bt=["disabled"],St=["disabled"],Ut={class:"form-group full-width"},Kt={class:"input-wrapper"},Mt=["disabled"],Tt={class:"modal-footer"},Vt=["disabled"],At=["disabled"],Nt={__name:"Cells",setup($t){const h=W(),x=v([]),z=v([]),B=v([]),S=v(!0),l=v(!1),U=v(!1),m=v(null),K=v(""),A=v(null),u=v({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0}),H=["Senin","Selasa","Rabu","Kamis","Jumat","Sabtu","Minggu"],e=v({cell_code:"",name:"",cell_type_id:"",church_area_id:"",activity_address:"",activity_day:"",activity_time:"",activity_time_start:"",activity_time_end:"",start_date:"",status:"aktif",description:"",branch_id:null}),_=async(p=1)=>{if(h.activeBranch){S.value=!0;try{const[t,s,M]=await Promise.all([y.get("/cells",{params:{branch_id:h.activeBranch.id,page:p,per_page:u.value.per_page,search:K.value}}),y.get("/cell-types",{params:{branch_id:h.activeBranch.id}}),y.get("/church-areas",{params:{branch_id:h.activeBranch.id}})]);x.value=t.data.data,u.value={current_page:t.data.current_page,last_page:t.data.last_page,per_page:t.data.per_page,total:t.data.total,from:t.data.from,to:t.data.to},z.value=s.data,B.value=M.data}catch(t){console.error("Failed to fetch data",t),f.fire("Error","Gagal memuat data.","error")}finally{S.value=!1}}},I=()=>{clearTimeout(A.value),A.value=setTimeout(()=>{_(1)},500)};F(()=>h.activeBranch,p=>{p&&_(1)},{immediate:!0}),j(()=>{_()});const N=(p=null)=>{p?(m.value=p.id,e.value={...p}):(m.value=null,e.value={cell_code:"",name:"",cell_type_id:"",church_area_id:"",activity_address:"",activity_day:"",activity_time:"",activity_time_start:"",activity_time_end:"",start_date:"",status:"aktif",description:"",branch_id:h.activeBranch?.id}),U.value=!0},k=()=>{U.value=!1},R=async()=>{if(!e.value.branch_id){f.fire("Error","Silakan pilih cabang terlebih dahulu.","error");return}l.value=!0;try{m.value?await y.put(`/cells/${m.value}`,e.value):await y.post("/cells",e.value),await _(u.value.current_page),k(),f.fire({icon:"success",title:"Berhasil!",text:"Data komunitas cell telah diperbarui.",timer:2e3,showConfirmButton:!1})}catch(p){const t=p.response?.data?.message||"Gagal menyimpan data.";f.fire("Error",t,"error")}finally{l.value=!1}},q=async p=>{if((await f.fire({title:"Apakah Anda yakin?",text:`Komunitas "${p.name}" akan dihapus permanen!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed)try{await y.delete(`/cells/${p.id}`),await _(u.value.current_page),f.fire("Dihapus!","Data telah berhasil dihapus.","success")}catch{f.fire("Error","Gagal menghapus data.","error")}};return(p,t)=>(d(),r("div",ua,[a("div",pa,[t[21]||(t[21]=a("div",{class:"title-group"},[a("h1",{class:"page-title"},"Master Komunitas Cell"),a("p",{class:"page-subtitle"},"Kelola daftar komunitas cell, jadwal kegiatan, dan lokasi pertemuan")],-1)),a("div",ca,[a("div",va,[o(i(D),{size:"18",class:"search-icon"}),c(a("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>K.value=s),type:"text",placeholder:"Cari komunitas...",class:"search-input",onInput:I,disabled:l.value},null,40,ma),[[b,K.value]])]),a("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=s=>N()),disabled:l.value},[o(i(L),{size:"18"}),t[19]||(t[19]=$()),t[20]||(t[20]=a("span",null,"Tambah Komunitas",-1))],8,_a)])]),a("div",ba,[S.value?(d(),r("div",fa,[...t[22]||(t[22]=[a("div",{class:"spinner"},null,-1),a("p",null,"Memuat data komunitas...",-1)])])):x.value.length===0?(d(),r("div",ha,[a("div",ga,[o(i(D),{size:"48"})]),t[23]||(t[23]=a("p",null,"Tidak ada data yang ditemukan.",-1))])):(d(),r("div",ya,[a("table",ka,[t[26]||(t[26]=a("thead",null,[a("tr",null,[a("th",{style:{width:"120px"}},"Kode"),a("th",null,"Nama Komunitas"),a("th",null,"Jenis"),a("th",null,"Wilayah"),a("th",{style:{width:"180px"}},"Jadwal & Waktu"),a("th",null,"Status"),a("th",{class:"text-right"},"Aksi")])],-1)),a("tbody",null,[(d(!0),r(g,null,C(x.value,s=>(d(),r("tr",{key:s.id,class:"row-hover"},[a("td",null,[a("span",Ca,n(s.cell_code),1)]),a("td",null,[a("div",wa,[a("span",xa,n(s.name),1),t[24]||(t[24]=a("br",null,null,-1)),a("span",za,n(s.activity_address),1)])]),a("td",null,[a("span",Ba,n(s.cell_type?.name),1)]),a("td",null,n(s.church_area?.name),1),a("td",null,[a("div",Sa,[a("span",Ua,n(s.activity_day),1),s.activity_time_start?(d(),r("div",Ka,[o(i(V),{size:"12",class:"text-indigo-400"}),a("span",null,n(s.activity_time_start.substring(0,5)),1),t[25]||(t[25]=a("span",{class:"mx-1 opacity-50"},"-",-1)),a("span",null,n(s.activity_time_end?s.activity_time_end.substring(0,5):"Selesai"),1)])):(d(),r("span",Ma,"Jam tidak diatur"))])]),a("td",null,[a("span",{class:T(["status-pill",s.status==="aktif"?"active":"inactive"])},n(s.status==="aktif"?"Aktif":"Non-Aktif"),3)]),a("td",null,[a("div",Ta,[a("button",{class:"action-btn edit",onClick:M=>N(s),title:"Ubah",disabled:l.value},[o(i(E),{size:"16"})],8,Va),a("button",{class:"action-btn delete",onClick:M=>q(s),title:"Hapus",disabled:l.value},[o(i(aa),{size:"16"})],8,Aa)])])]))),128))])]),a("div",Na,[a("div",$a,[t[28]||(t[28]=a("span",{class:"text-xs font-bold text-muted"},"TAMPILKAN",-1)),c(a("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>u.value.per_page=s),onChange:t[3]||(t[3]=s=>_(1)),disabled:l.value},[...t[27]||(t[27]=[a("option",{value:10},"10 data",-1),a("option",{value:25},"25 data",-1),a("option",{value:50},"50 data",-1),a("option",{value:100},"100 data",-1)])],40,Pa),[[w,u.value.per_page]])]),a("div",Ja,[a("span",Da,[a("b",null,n(u.value.from||0)+"-"+n(u.value.to||0),1),t[29]||(t[29]=$(" dari ",-1)),a("b",null,n(u.value.total),1)]),a("div",La,[a("button",{class:"page-btn",disabled:u.value.current_page===1||l.value,onClick:t[4]||(t[4]=s=>_(u.value.current_page-1))},[o(i(O),{size:"18"})],8,Ea),a("button",{class:"page-btn",disabled:u.value.current_page===u.value.last_page||l.value,onClick:t[5]||(t[5]=s=>_(u.value.current_page+1))},[o(i(Z),{size:"18"})],8,Ha)])])])]))]),o(X,{name:"modal-fade"},{default:Q(()=>[U.value?(d(),r("div",{key:0,class:"modal-overlay",onClick:t[18]||(t[18]=P(s=>!l.value&&k(),["self"]))},[a("div",Ia,[a("div",Ra,[a("div",qa,[m.value?(d(),J(i(E),{key:1,size:"24"})):(d(),J(i(L),{key:0,size:"24"}))]),a("div",Ga,[a("h2",null,n(m.value?"Update Komunitas":"Tambah Komunitas Baru"),1),a("p",null,n(m.value?"Ubah informasi komunitas yang sudah ada":"Lengkapi informasi komunitas cell di bawah ini"),1)]),a("button",{class:"close-btn",onClick:k,disabled:l.value},[o(i(ta),{size:"20"})],8,Wa)]),a("form",{onSubmit:P(R,["prevent"]),class:"modal-body custom-scrollbar"},[a("div",Fa,[t[44]||(t[44]=a("div",{class:"form-section-title"},"Informasi Dasar",-1)),a("div",ja,[t[30]||(t[30]=a("label",{class:"form-label"},"Kode Cell",-1)),a("div",Qa,[o(i(ea),{size:"18",class:"input-icon"}),c(a("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>e.value.cell_code=s),type:"text",required:"",placeholder:"Contoh: CELL-001",disabled:l.value},null,8,Xa),[[b,e.value.cell_code]])])]),a("div",Ya,[t[31]||(t[31]=a("label",{class:"form-label"},"Nama Komunitas",-1)),a("div",Oa,[o(i(la),{size:"18",class:"input-icon"}),c(a("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>e.value.name=s),type:"text",required:"",placeholder:"Contoh: Cell Group Bethlehem",disabled:l.value},null,8,Za),[[b,e.value.name]])])]),a("div",at,[t[33]||(t[33]=a("label",{class:"form-label"},"Jenis Cell",-1)),a("div",tt,[o(i(ia),{size:"18",class:"input-icon"}),c(a("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>e.value.cell_type_id=s),required:"",disabled:l.value},[t[32]||(t[32]=a("option",{value:"",disabled:""},"Pilih Jenis",-1)),(d(!0),r(g,null,C(z.value.data||z.value,s=>(d(),r("option",{key:s.id,value:s.id},n(s.name),9,et))),128))],8,st),[[w,e.value.cell_type_id]])])]),a("div",lt,[t[35]||(t[35]=a("label",{class:"form-label"},"Wilayah",-1)),a("div",it,[o(i(oa),{size:"18",class:"input-icon"}),c(a("select",{"onUpdate:modelValue":t[9]||(t[9]=s=>e.value.church_area_id=s),required:"",disabled:l.value},[t[34]||(t[34]=a("option",{value:"",disabled:""},"Pilih Wilayah",-1)),(d(!0),r(g,null,C(B.value.data||B.value,s=>(d(),r("option",{key:s.id,value:s.id},n(s.name),9,nt))),128))],8,ot),[[w,e.value.church_area_id]])])]),t[45]||(t[45]=a("div",{class:"form-section-title"},"Jadwal & Lokasi",-1)),a("div",dt,[t[36]||(t[36]=a("label",{class:"form-label"},"Alamat Kegiatan",-1)),a("div",rt,[o(i(na),{size:"18",class:"input-icon"}),c(a("input",{"onUpdate:modelValue":t[10]||(t[10]=s=>e.value.activity_address=s),type:"text",placeholder:"Contoh: Jl. Mangga No. 12",disabled:l.value},null,8,ut),[[b,e.value.activity_address]])])]),a("div",pt,[t[38]||(t[38]=a("label",{class:"form-label"},"Hari Kegiatan",-1)),a("div",ct,[o(i(da),{size:"18",class:"input-icon"}),c(a("select",{"onUpdate:modelValue":t[11]||(t[11]=s=>e.value.activity_day=s),disabled:l.value},[t[37]||(t[37]=a("option",{value:""},"Pilih Hari",-1)),(d(),r(g,null,C(H,s=>a("option",{key:s,value:s},n(s),9,mt)),64))],8,vt),[[w,e.value.activity_day]])])]),a("div",_t,[t[39]||(t[39]=a("label",{class:"form-label"},"Jam Mulai",-1)),a("div",bt,[o(i(V),{size:"18",class:"input-icon"}),c(a("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>e.value.activity_time_start=s),type:"time",disabled:l.value},null,8,ft),[[b,e.value.activity_time_start]])])]),a("div",ht,[t[40]||(t[40]=a("label",{class:"form-label"},"Jam Selesai",-1)),a("div",gt,[o(i(V),{size:"18",class:"input-icon"}),c(a("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>e.value.activity_time_end=s),type:"time",disabled:l.value},null,8,yt),[[b,e.value.activity_time_end]])])]),t[46]||(t[46]=a("div",{class:"form-section-title"},"Pengaturan Tambahan",-1)),a("div",kt,[t[41]||(t[41]=a("label",{class:"form-label"},"Tanggal Mulai",-1)),a("div",Ct,[o(i(ra),{size:"18",class:"input-icon"}),c(a("input",{"onUpdate:modelValue":t[14]||(t[14]=s=>e.value.start_date=s),type:"date",disabled:l.value},null,8,wt),[[b,e.value.start_date]])])]),a("div",xt,[t[42]||(t[42]=a("label",{class:"form-label"},"Status",-1)),a("div",zt,[a("button",{type:"button",class:T(["status-btn",{active:e.value.status==="aktif"}]),onClick:t[15]||(t[15]=s=>e.value.status="aktif"),disabled:l.value},"Aktif",10,Bt),a("button",{type:"button",class:T(["status-btn",{active:e.value.status==="nonaktif"}]),onClick:t[16]||(t[16]=s=>e.value.status="nonaktif"),disabled:l.value},"Non-Aktif",10,St)])]),a("div",Ut,[t[43]||(t[43]=a("label",{class:"form-label"},"Keterangan",-1)),a("div",Kt,[c(a("textarea",{"onUpdate:modelValue":t[17]||(t[17]=s=>e.value.description=s),rows:"3",placeholder:"Informasi tambahan...",disabled:l.value},null,8,Mt),[[b,e.value.description]])])])]),a("div",Tt,[a("button",{type:"button",class:"btn btn-ghost",onClick:k,disabled:l.value},"Batal",8,Vt),a("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:l.value},[l.value?(d(),r(g,{key:0},[t[47]||(t[47]=a("div",{class:"spinner small"},null,-1)),t[48]||(t[48]=a("span",null,"Menyimpan...",-1))],64)):(d(),r(g,{key:1},[o(i(sa),{size:"18"}),a("span",null,n(m.value?"Update Komunitas":"Simpan Komunitas"),1)],64))],8,At)])],32)])])):Y("",!0)]),_:1})]))}},Zt=G(Nt,[["__scopeId","data-v-acbbaaf0"]]);export{Zt as default};
