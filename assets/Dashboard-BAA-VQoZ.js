import{_ as I,u as T,r as c,z as x,A as z,i as F,c as l,a as t,t as a,k as i,F as w,d as r,h as y,n as U,j as L,o}from"./index-Mv3MxCR1.js";import{S as M}from"./sweetalert2.esm.all-BQxta0Da.js";import{U as D}from"./users-D_w7s7_7.js";import{C as N}from"./circle-check-big-BN4MHkMS.js";import{B as Y}from"./briefcase-DeOdw5oH.js";import{C as $,a as j,S as J}from"./send-CpjUWACe.js";import{C as K}from"./calendar-COvuOzBD.js";import"./createLucideIcon-DBeZuCHW.js";const V={class:"master-data-page dashboard-viewport"},R={class:"header-section mb-10"},W={class:"title-group"},q={class:"flex items-center gap-2 mt-1"},E={class:"page-subtitle !text-slate-500 !italic"},O={class:"header-time-premium hidden lg:flex flex-col items-end"},P={class:"digital-clock"},X={class:"calendar-date"},G={class:"stats-container-premium mb-20"},H={class:"card stat-card-premium blue-wing group"},Q={class:"stat-main"},Z={class:"stat-icon-bg bg-blue-50 text-blue-600"},tt={class:"stat-details"},st={class:"stat-number"},at={class:"card stat-card-premium green-wing group"},et={class:"stat-main"},nt={class:"stat-icon-bg bg-emerald-50 text-emerald-600"},it={class:"stat-details"},lt={class:"stat-number"},ot={class:"card stat-card-premium amber-wing group"},rt={class:"stat-main"},dt={class:"stat-icon-bg bg-amber-50 text-amber-600"},ct={class:"stat-details"},ut={class:"stat-number"},mt={class:"content-section mt-2"},gt={class:"card table-card premium-shadow overflow-hidden"},_t={class:"card-header-bar"},ht={class:"flex items-center gap-4"},vt={class:"header-icon-box bg-pink-500"},bt={class:"text-xs font-bold text-slate-400 uppercase tracking-widest"},pt={class:"count-pill"},ft={class:"table-v-scroll custom-scrollbar"},kt={key:0,class:"table-loading-state"},xt={key:1,class:"modern-table"},wt={class:"text-center"},yt={class:"row-number"},Dt={class:"user-info-cell"},Bt={class:"user-avatar shadow-sm"},Ct=["src"],St={key:1,class:"avatar-letter"},At={class:"user-text"},It={class:"user-name"},Tt={class:"date-badge"},zt={class:"text-center"},Ft={class:"age-pill"},Ut={class:"text-right pr-8"},Lt=["onClick"],Mt={key:2,class:"empty-data-state py-20"},Nt={class:"empty-icon-circle"},Yt={key:1,class:"greeting-container"},$t={class:"card greeting-card"},jt={class:"greeting-content"},Jt={class:"greeting-icon"},Kt={class:"greeting-title"},Vt={class:"greeting-subtitle"},Rt={class:"greeting-time"},Wt={class:"time-display-large"},qt={class:"date-display-large"},Et={__name:"Dashboard",setup(Ot){const d=T(),u=c({}),m=c([]),_=c(!0),h=c(""),v=c(""),B=x(()=>new Intl.DateTimeFormat("id-ID",{month:"long"}).format(new Date)),C=x(()=>new Intl.DateTimeFormat("id-ID",{year:"numeric"}).format(new Date)),p=()=>{const e=new Date;h.value=e.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),v.value=e.toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"})},f=async()=>{if(d.activeBranch){_.value=!0;try{const e=await L.get("/dashboard/stats",{params:{church_id:d.activeBranch.id}});u.value=e.data.stats,m.value=e.data.birthdays}catch(e){console.error("Failed to fetch dashboard stats:",e)}finally{_.value=!1}}},S=e=>new Date(e).toLocaleDateString("id-ID",{day:"numeric",month:"long"}),k=e=>{const s=new Date(e),n=new Date;let g=n.getFullYear()-s.getFullYear();const b=n.getMonth()-s.getMonth();return(b<0||b===0&&n.getDate()<s.getDate())&&g--,g},A=e=>{M.fire({title:"Kirim Ucapan?",html:`Kirim pesan selamat ulang tahun untuk <b class="text-indigo-600">${e.nama_lengkap}</b>?`,icon:"question",showCancelButton:!0,confirmButtonText:"Ya, Kirim WA",confirmButtonColor:"#10b981",cancelButtonColor:"#94a3b8",reverseButtons:!0}).then(s=>{if(s.isConfirmed){const n=`Selamat ulang tahun ke-${k(e.tanggal_lahir)} untuk Bapak/Ibu/Sdr ${e.nama_lengkap}. Tuhan Yesus Memberkati!`;window.open(`https://wa.me/?text=${encodeURIComponent(n)}`,"_blank")}})};return z(()=>d.activeBranch,()=>{f()}),F(()=>{p(),setInterval(p,1e3),f()}),(e,s)=>(o(),l("div",V,[t("div",R,[t("div",W,[s[1]||(s[1]=t("h1",{class:"page-title !text-4xl"},"Dashboard Overview",-1)),t("div",q,[s[0]||(s[0]=t("div",{class:"w-10 h-1 bg-indigo-600 rounded-full"},null,-1)),t("p",E,"Ringkasan aktivitas gereja di cabang "+a(i(d).activeBranch?.name),1)])]),t("div",O,[t("span",P,a(h.value),1),t("span",X,a(v.value),1)])]),i(d).user?.akses_dashboard?(o(),l(w,{key:0},[t("div",G,[t("div",H,[t("div",Q,[t("div",Z,[r(i(D),{size:"28"})]),t("div",tt,[s[2]||(s[2]=t("span",{class:"stat-tag text-blue-600 bg-blue-50"},"Active",-1)),t("div",st,a(u.value.total_members||0),1),s[3]||(s[3]=t("h3",{class:"stat-title"},"Total Jemaat",-1))])]),s[4]||(s[4]=t("div",{class:"hover-glow bg-blue-400/20"},null,-1))]),t("div",at,[t("div",et,[t("div",nt,[r(i(N),{size:"28"})]),t("div",it,[s[5]||(s[5]=t("span",{class:"stat-tag text-emerald-600 bg-emerald-50"},"Success",-1)),t("div",lt,a(u.value.served_members||0),1),s[6]||(s[6]=t("h3",{class:"stat-title"},"Layanan Selesai",-1))])]),s[7]||(s[7]=t("div",{class:"hover-glow bg-emerald-400/20"},null,-1))]),t("div",ot,[t("div",rt,[t("div",dt,[r(i(Y),{size:"28"})]),t("div",ct,[s[8]||(s[8]=t("span",{class:"stat-tag text-amber-600 bg-amber-50"},"Assigned",-1)),t("div",ut,a(u.value.active_servers||0),1),s[9]||(s[9]=t("h3",{class:"stat-title"},"Pelayan Aktif",-1))])]),s[10]||(s[10]=t("div",{class:"hover-glow bg-amber-400/20"},null,-1))])]),t("div",mt,[t("div",gt,[t("div",_t,[t("div",ht,[t("div",vt,[r(i($),{size:"24",class:"text-white"})]),t("div",null,[s[11]||(s[11]=t("h2",{class:"text-xl font-black text-slate-800"},"Ulang Tahun Bulan Ini",-1)),t("p",bt,a(B.value+", "+C.value),1)])]),t("div",pt,[s[12]||(s[12]=t("span",{class:"pulse-dot"},null,-1)),t("b",null,a(m.value.length),1),s[13]||(s[13]=y(" Jemaat ",-1))])]),t("div",ft,[_.value?(o(),l("div",kt,[...s[14]||(s[14]=[t("div",{class:"spinner-dual"},null,-1),t("p",null,"Menyelaraskan Data Jemaat...",-1)])])):m.value.length>0?(o(),l("table",xt,[s[17]||(s[17]=t("thead",null,[t("tr",null,[t("th",{class:"text-center w-16"},"No"),t("th",null,"Informasi Jemaat"),t("th",null,"Tanggal Lahir"),t("th",{class:"text-center"},"Umur"),t("th",{class:"text-right pr-8"},"Aksi")])],-1)),t("tbody",null,[(o(!0),l(w,null,U(m.value,(n,g)=>(o(),l("tr",{key:n.id,class:"row-hover-premium"},[t("td",wt,[t("span",yt,a(g+1),1)]),t("td",null,[t("div",Dt,[t("div",Bt,[n.foto?(o(),l("img",{key:0,src:n.foto},null,8,Ct)):(o(),l("div",St,a(n.nama_lengkap.charAt(0)),1))]),t("div",At,[t("span",It,a(n.nama_lengkap),1),s[15]||(s[15]=t("span",{class:"user-status"},"Anggota Aktif",-1))])])]),t("td",null,[t("div",Tt,[r(i(K),{size:"12"}),t("span",null,a(S(n.tanggal_lahir)),1)])]),t("td",zt,[t("span",Ft,a(k(n.tanggal_lahir))+" th",1)]),t("td",Ut,[t("button",{class:"btn-wa-action",onClick:b=>A(n)},[r(i(J),{size:"14"}),s[16]||(s[16]=t("span",null,"Kirim Ucapan",-1))],8,Lt)])]))),128))])])):(o(),l("div",Mt,[t("div",Nt,[r(i(j),{size:"40",class:"text-slate-300"})]),s[18]||(s[18]=t("p",null,"Tidak ada jemaat yang berulang tahun pada bulan ini.",-1))]))])])])],64)):(o(),l("div",Yt,[t("div",$t,[t("div",jt,[t("div",Jt,[r(i(D),{size:"64",class:"text-indigo-400"})]),t("h2",Kt,"Selamat Datang, "+a(i(d).user?.name)+"!",1),t("p",Vt,[s[19]||(s[19]=y("Anda terhubung ke cabang ",-1)),t("b",null,a(i(d).activeBranch?.name),1)]),t("div",Rt,[t("div",Wt,a(h.value),1),t("div",qt,a(v.value),1)]),s[20]||(s[20]=t("div",{class:"greeting-message"},[t("p",null,"Akses dashboard Anda terbatas. Silakan hubungi administrator untuk informasi lebih lanjut.")],-1))])])]))]))}},as=I(Et,[["__scopeId","data-v-93da938d"]]);export{as as default};
