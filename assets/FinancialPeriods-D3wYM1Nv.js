import{_ as E,u as H,r as p,i as K,c,a as e,d as n,b as f,k as l,v as h,h as _,F as T,n as R,l as j,t as r,e as G,T as Q,j as k,o as u,q as P,x as X,w as $,m as N}from"./index-Mv3MxCR1.js";import{S as b}from"./sweetalert2.esm.all-BQxta0Da.js";import{S as Y}from"./search-DW_529iS.js";import{P as U}from"./plus-BF4bXWAK.js";import{C as z}from"./calendar-COvuOzBD.js";import{C as J}from"./chevron-left-C_DfDUMJ.js";import{C as O}from"./chevron-right-u8dkcCrv.js";import{A as W}from"./arrow-right-DJNCVpif.js";import{P as V,T as Z}from"./trash-2-CXOSxmzs.js";import{X as ee,C as ae}from"./x-D8hPaNXE.js";import{F as te}from"./file-text-CPaFxqa6.js";import"./createLucideIcon-DBeZuCHW.js";const se={class:"master-data-page wide"},le={class:"header-section"},oe={class:"header-actions"},ne={class:"search-wrapper"},ie={class:"card table-card"},de={key:0,class:"loading-state"},re={key:1,class:"empty-state"},ue={class:"empty-icon"},pe={key:2,class:"table-container"},ce={class:"modern-table"},ve={class:"name-column"},me={class:"font-bold text-dark"},_e={class:"text-xs text-muted"},fe={class:"text-slate-600 font-medium"},be={class:"actions-group"},ge=["onClick"],he=["onClick"],ke={class:"pagination-footer"},ye={class:"per-page-selector"},Ce={class:"pagination-controls"},we={class:"page-info"},xe={class:"page-buttons"},Te=["disabled"],Pe=["disabled"],ze={class:"modal-content"},Be={class:"modal-header"},Se={class:"header-icon"},De={class:"header-text"},Ae=["disabled"],Me={class:"form-grid"},$e={class:"form-group full-width"},Ne={class:"input-wrapper"},Ue=["disabled"],Ve={class:"form-group"},Fe={class:"input-wrapper"},qe=["disabled"],Ie={class:"form-group"},Le={class:"input-wrapper"},Ee=["disabled"],He={class:"form-group full-width"},Ke={class:"status-toggle-group"},Re=["disabled"],je=["disabled"],Ge={class:"modal-footer"},Qe=["disabled"],Xe=["disabled"],Ye={__name:"FinancialPeriods",setup(Je){const B=H(),y=p([]),C=p(!0),d=p(!1),w=p(!1),v=p(null),x=p(""),S=p(null),i=p({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0}),D=()=>({church_id:B.activeBranch,name:"",start_date:"",end_date:"",is_active:!0}),o=p(D()),m=async(s=1)=>{C.value=!0;try{const a=await k.get("/financial-periods",{params:{page:s,per_page:i.value.per_page,search:x.value,church_id:B.activeBranch}});y.value=a.data.data,i.value={current_page:a.data.current_page,last_page:a.data.last_page,per_page:a.data.per_page,total:a.data.total,from:a.data.from,to:a.data.to}}catch(a){console.error("Fetch error:",a)}finally{C.value=!1}},F=()=>{clearTimeout(S.value),S.value=setTimeout(()=>m(1),500)},A=s=>s?new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-",M=(s=null)=>{s?(v.value=s.id,o.value={...s,start_date:s.start_date.split("T")[0],end_date:s.end_date.split("T")[0]}):(v.value=null,o.value=D()),w.value=!0},g=()=>{w.value=!1},q=async()=>{d.value=!0;try{v.value?await k.put(`/financial-periods/${v.value}`,o.value):await k.post("/financial-periods",o.value),b.fire({icon:"success",title:"Berhasil",timer:2e3,showConfirmButton:!1}),m(i.value.current_page),g()}catch(s){b.fire("Error",s.response?.data?.message||"Gagal menyimpan data","error")}finally{d.value=!1}},I=async s=>{if((await b.fire({title:"Hapus Periode?",text:"Data yang dihapus tidak dapat dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",confirmButtonText:"Ya, Hapus"})).isConfirmed)try{await k.delete(`/financial-periods/${s.id}`),m(),b.fire("Terhapus!","Periode telah dihapus.","success")}catch{b.fire("Error","Gagal menghapus data","error")}};return K(()=>{m()}),(s,a)=>(u(),c("div",se,[e("div",le,[a[14]||(a[14]=e("div",{class:"title-group"},[e("h1",{class:"page-title"},"Periode Keuangan"),e("p",{class:"page-subtitle"},"Kelola siklus pelaporan dan pembukuan anggaran gereja")],-1)),e("div",oe,[e("div",ne,[n(l(Y),{size:"18",class:"search-icon"}),f(e("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>x.value=t),type:"text",placeholder:"Cari periode...",class:"search-input",onInput:F},null,544),[[h,x.value]])]),e("button",{class:"btn btn-primary",onClick:a[1]||(a[1]=t=>M())},[n(l(U),{size:"18"}),a[12]||(a[12]=_()),a[13]||(a[13]=e("span",null,"Tambah Periode",-1))])])]),e("div",ie,[C.value?(u(),c("div",de,[...a[15]||(a[15]=[e("div",{class:"spinner"},null,-1),e("p",null,"Memuat data periode...",-1)])])):y.value.length===0?(u(),c("div",re,[e("div",ue,[n(l(z),{size:"48"})]),a[16]||(a[16]=e("p",null,"Tidak ada periode ditemukan.",-1))])):(u(),c("div",pe,[e("table",ce,[a[17]||(a[17]=e("thead",null,[e("tr",null,[e("th",{style:{width:"250px"}},"Nama Periode"),e("th",null,"Rentang Tanggal"),e("th",null,"Status"),e("th",{class:"text-right"},"Aksi")])],-1)),e("tbody",null,[(u(!0),c(T,null,R(y.value,t=>(u(),c("tr",{key:t.id,class:"row-hover"},[e("td",null,[e("div",ve,[e("span",me,r(t.name),1),e("span",_e,"ID: #"+r(t.id),1)])]),e("td",fe,[_(r(A(t.start_date))+" ",1),n(l(W),{size:"12",class:"mx-2 text-slate-300"}),_(" "+r(A(t.end_date)),1)]),e("td",null,[e("span",{class:P(["status-pill",t.is_active?"active":"inactive"])},r(t.is_active?"Aktif":"Non-Aktif"),3)]),e("td",null,[e("div",be,[e("button",{class:"action-btn edit",onClick:L=>M(t),title:"Ubah"},[n(l(V),{size:"16"})],8,ge),e("button",{class:"action-btn delete",onClick:L=>I(t),title:"Hapus"},[n(l(Z),{size:"16"})],8,he)])])]))),128))])]),e("div",ke,[e("div",ye,[a[19]||(a[19]=e("span",null,"TAMPILKAN",-1)),f(e("select",{"onUpdate:modelValue":a[2]||(a[2]=t=>i.value.per_page=t),onChange:a[3]||(a[3]=t=>m(1))},[...a[18]||(a[18]=[e("option",{value:10},"10 data",-1),e("option",{value:25},"25 data",-1),e("option",{value:50},"50 data",-1)])],544),[[j,i.value.per_page]])]),e("div",Ce,[e("span",we,[e("b",null,r(i.value.from||0)+"-"+r(i.value.to||0),1),a[20]||(a[20]=_(" dari ",-1)),e("b",null,r(i.value.total),1)]),e("div",xe,[e("button",{class:"page-btn",disabled:i.value.current_page===1,onClick:a[4]||(a[4]=t=>m(i.value.current_page-1))},[n(l(J),{size:"18"})],8,Te),e("button",{class:"page-btn",disabled:i.value.current_page===i.value.last_page,onClick:a[5]||(a[5]=t=>m(i.value.current_page+1))},[n(l(O),{size:"18"})],8,Pe)])])])]))]),n(Q,{name:"modal-fade"},{default:G(()=>[w.value?(u(),c("div",{key:0,class:"modal-overlay",onClick:a[11]||(a[11]=$(t=>!d.value&&g(),["self"]))},[e("div",ze,[e("div",Be,[e("div",Se,[v.value?(u(),N(l(V),{key:1,size:"24"})):(u(),N(l(U),{key:0,size:"24"}))]),e("div",De,[e("h2",null,r(v.value?"Update Periode":"Tambah Periode Baru"),1),e("p",null,r(v.value?"Ubah informasi periode yang sudah ada":"Atur rentang waktu pembukuan finansial"),1)]),e("button",{class:"close-btn",onClick:g,disabled:d.value},[n(l(ee),{size:"20"})],8,Ae)]),e("form",{onSubmit:$(q,["prevent"]),class:"modal-body"},[e("div",Me,[e("div",$e,[a[21]||(a[21]=e("label",{class:"form-label"},[_("Nama Periode "),e("span",{class:"required"},"*")],-1)),e("div",Ne,[n(l(te),{size:"18",class:"input-icon"}),f(e("input",{"onUpdate:modelValue":a[6]||(a[6]=t=>o.value.name=t),type:"text",required:"",placeholder:"Contoh: Tahun Buku 2024",disabled:d.value},null,8,Ue),[[h,o.value.name]])])]),e("div",Ve,[a[22]||(a[22]=e("label",{class:"form-label"},[_("Tanggal Mulai "),e("span",{class:"required"},"*")],-1)),e("div",Fe,[n(l(z),{size:"18",class:"input-icon"}),f(e("input",{"onUpdate:modelValue":a[7]||(a[7]=t=>o.value.start_date=t),type:"date",required:"",disabled:d.value},null,8,qe),[[h,o.value.start_date]])])]),e("div",Ie,[a[23]||(a[23]=e("label",{class:"form-label"},[_("Tanggal Selesai "),e("span",{class:"required"},"*")],-1)),e("div",Le,[n(l(z),{size:"18",class:"input-icon"}),f(e("input",{"onUpdate:modelValue":a[8]||(a[8]=t=>o.value.end_date=t),type:"date",required:"",disabled:d.value},null,8,Ee),[[h,o.value.end_date]])])]),e("div",He,[a[24]||(a[24]=e("label",{class:"form-label"},"Status Periode",-1)),e("div",Ke,[e("button",{type:"button",class:P(["status-btn",{active:o.value.is_active}]),onClick:a[9]||(a[9]=t=>o.value.is_active=!0),disabled:d.value},"Aktif",10,Re),e("button",{type:"button",class:P(["status-btn",{active:!o.value.is_active}]),onClick:a[10]||(a[10]=t=>o.value.is_active=!1),disabled:d.value},"Non-Aktif",10,je)])])]),e("div",Ge,[e("button",{type:"button",class:"btn btn-ghost",onClick:g,disabled:d.value},"Batal",8,Qe),e("button",{type:"submit",class:"btn btn-primary",disabled:d.value},[d.value?(u(),c(T,{key:0},[a[25]||(a[25]=e("div",{class:"spinner small"},null,-1)),a[26]||(a[26]=e("span",null,"Menyimpan...",-1))],64)):(u(),c(T,{key:1},[n(l(ae),{size:"18"}),e("span",null,r(v.value?"Update Data":"Simpan Periode"),1)],64))],8,Xe)])],32)])])):X("",!0)]),_:1})]))}},ra=E(Ye,[["__scopeId","data-v-7e5184cc"]]);export{ra as default};
