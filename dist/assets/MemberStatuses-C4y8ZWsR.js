import{_ as I,u as F,r as d,A as G,i as J,c as u,a,d as i,b as S,k as n,v as T,h as M,F as w,n as L,l as H,t as v,e as K,T as q,j as f,o as r,x as Q,w as z,m as $}from"./index-Mv3MxCR1.js";import{S as b}from"./sweetalert2.esm.all-BQxta0Da.js";import{S as D}from"./search-DW_529iS.js";import{P as N}from"./plus-BF4bXWAK.js";import{C as R}from"./chevron-left-C_DfDUMJ.js";import{C as X}from"./chevron-right-u8dkcCrv.js";import{P as A,T as Y}from"./trash-2-CXOSxmzs.js";import{X as O,C as W}from"./x-D8hPaNXE.js";import{T as Z}from"./type-zrf9LQ7g.js";import"./createLucideIcon-DBeZuCHW.js";const aa={class:"master-data-page"},ta={class:"header-section"},ea={class:"header-actions"},sa={class:"search-wrapper"},la=["disabled"],oa=["disabled"],na={class:"card table-card"},ia={key:0,class:"loading-state"},ra={key:1,class:"empty-state"},da={class:"empty-icon"},ua={key:2,class:"table-container"},ca={class:"modern-table"},pa={class:"order-badge"},va={class:"font-bold text-dark"},ma={class:"actions-group"},ba=["onClick","disabled"],_a=["onClick","disabled"],ha={class:"pagination-footer"},fa={class:"per-page-selector"},ga=["disabled"],ya={class:"pagination-controls"},ka={class:"page-info"},Ca={class:"page-buttons"},Sa=["disabled"],wa=["disabled"],xa={class:"modal-content"},Ba={class:"modal-header"},Ta={class:"header-icon"},Ma={class:"header-text"},za=["disabled"],$a={class:"form-section"},Da={class:"form-group full-width"},Na={class:"input-wrapper"},Aa=["disabled"],Ua={class:"modal-footer"},Va=["disabled"],ja=["disabled"],Ea={__name:"MemberStatuses",setup(Pa){const _=F(),g=d([]),y=d(!0),s=d(!1),k=d(!1),c=d(null),C=d(""),x=d(null),l=d({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0}),m=d({name:"",branch_id:null}),p=async(o=1)=>{if(_.activeBranch){y.value=!0;try{const t=await f.get("/member-statuses",{params:{branch_id:_.activeBranch.id,page:o,per_page:l.value.per_page,search:C.value}});g.value=t.data.data,l.value={current_page:t.data.current_page,last_page:t.data.last_page,per_page:t.data.per_page,total:t.data.total,from:t.data.from,to:t.data.to}}catch(t){console.error("Failed to fetch member statuses",t),b.fire("Error","Gagal memuat data status jemaat.","error")}finally{y.value=!1}}},U=()=>{clearTimeout(x.value),x.value=setTimeout(()=>{p(1)},500)};G(()=>_.activeBranch,o=>{o&&p(1)},{immediate:!0}),J(()=>{p()});const B=(o=null)=>{o?(c.value=o.id,m.value={name:o.name,branch_id:o.branch_id}):(c.value=null,m.value={name:"",branch_id:_.activeBranch?.id}),k.value=!0},h=()=>{k.value=!1},V=async()=>{if(!m.value.branch_id){b.fire("Error","Silakan pilih cabang terlebih dahulu.","error");return}s.value=!0;try{c.value?await f.put(`/member-statuses/${c.value}`,m.value):await f.post("/member-statuses",m.value),await p(l.value.current_page),h(),b.fire({icon:"success",title:"Berhasil!",text:"Data status jemaat telah diperbarui.",timer:2e3,showConfirmButton:!1})}catch{b.fire("Error","Gagal menyimpan data.","error")}finally{s.value=!1}},j=async o=>{if((await b.fire({title:"Apakah Anda yakin?",text:`Status "${o.name}" akan dihapus permanen!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed)try{await f.delete(`/member-statuses/${o.id}`),await p(l.value.current_page),b.fire("Dihapus!","Data telah berhasil dihapus.","success")}catch{b.fire("Error","Gagal menghapus data.","error")}};return(o,t)=>(r(),u("div",aa,[a("div",ta,[t[10]||(t[10]=a("div",{class:"title-group"},[a("h1",{class:"page-title"},"Master Status Jemaat"),a("p",{class:"page-subtitle"},"Kelola daftar status jemaat di cabang ini")],-1)),a("div",ea,[a("div",sa,[i(n(D),{size:"18",class:"search-icon"}),S(a("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>C.value=e),type:"text",placeholder:"Cari status...",class:"search-input",onInput:U,disabled:s.value},null,40,la),[[T,C.value]])]),a("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=e=>B()),disabled:s.value},[i(n(N),{size:"18"}),t[8]||(t[8]=M()),t[9]||(t[9]=a("span",null,"Tambah Status",-1))],8,oa)])]),a("div",na,[y.value?(r(),u("div",ia,[...t[11]||(t[11]=[a("div",{class:"spinner"},null,-1),a("p",null,"Memuat data...",-1)])])):g.value.length===0?(r(),u("div",ra,[a("div",da,[i(n(D),{size:"48"})]),t[12]||(t[12]=a("p",null,"Tidak ada data yang ditemukan.",-1))])):(r(),u("div",ua,[a("table",ca,[t[13]||(t[13]=a("thead",null,[a("tr",null,[a("th",{style:{width:"80px"}},"No"),a("th",null,"Nama Status"),a("th",{class:"text-right"},"Aksi")])],-1)),a("tbody",null,[(r(!0),u(w,null,L(g.value,(e,E)=>(r(),u("tr",{key:e.id,class:"row-hover"},[a("td",null,[a("span",pa,v(l.value.from+E),1)]),a("td",va,v(e.name),1),a("td",null,[a("div",ma,[a("button",{class:"action-btn edit",onClick:P=>B(e),title:"Ubah",disabled:s.value},[i(n(A),{size:"16"})],8,ba),a("button",{class:"action-btn delete",onClick:P=>j(e),title:"Hapus",disabled:s.value},[i(n(Y),{size:"16"})],8,_a)])])]))),128))])]),a("div",ha,[a("div",fa,[t[15]||(t[15]=a("span",{class:"text-xs font-bold text-muted"},"TAMPILKAN",-1)),S(a("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>l.value.per_page=e),onChange:t[3]||(t[3]=e=>p(1)),disabled:s.value},[...t[14]||(t[14]=[a("option",{value:10},"10 data",-1),a("option",{value:25},"25 data",-1),a("option",{value:50},"50 data",-1),a("option",{value:100},"100 data",-1)])],40,ga),[[H,l.value.per_page]])]),a("div",ya,[a("span",ka,[a("b",null,v(l.value.from||0)+"-"+v(l.value.to||0),1),t[16]||(t[16]=M(" dari ",-1)),a("b",null,v(l.value.total),1)]),a("div",Ca,[a("button",{class:"page-btn",disabled:l.value.current_page===1||s.value,onClick:t[4]||(t[4]=e=>p(l.value.current_page-1))},[i(n(R),{size:"18"})],8,Sa),a("button",{class:"page-btn",disabled:l.value.current_page===l.value.last_page||s.value,onClick:t[5]||(t[5]=e=>p(l.value.current_page+1))},[i(n(X),{size:"18"})],8,wa)])])])]))]),i(q,{name:"modal-fade"},{default:K(()=>[k.value?(r(),u("div",{key:0,class:"modal-overlay",onClick:t[7]||(t[7]=z(e=>!s.value&&h(),["self"]))},[a("div",xa,[a("div",Ba,[a("div",Ta,[c.value?(r(),$(n(A),{key:1,size:"24"})):(r(),$(n(N),{key:0,size:"24"}))]),a("div",Ma,[a("h2",null,v(c.value?"Update Status":"Tambah Status Baru"),1),a("p",null,v(c.value?"Ubah informasi status jemaat yang sudah ada":"Masukkan nama status jemaat baru"),1)]),a("button",{class:"close-btn",onClick:h,disabled:s.value},[i(n(O),{size:"20"})],8,za)]),a("form",{onSubmit:z(V,["prevent"]),class:"modal-body"},[a("div",$a,[a("div",Da,[t[17]||(t[17]=a("label",{class:"form-label"},"Nama Status Jemaat",-1)),a("div",Na,[i(n(Z),{size:"18",class:"input-icon"}),S(a("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>m.value.name=e),type:"text",required:"",placeholder:"Contoh: Jemaat, Simpatisan, dll.",disabled:s.value},null,8,Aa),[[T,m.value.name]])])])]),a("div",Ua,[a("button",{type:"button",class:"btn btn-ghost",onClick:h,disabled:s.value},"Batal",8,Va),a("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:s.value},[s.value?(r(),u(w,{key:0},[t[18]||(t[18]=a("div",{class:"spinner small"},null,-1)),t[19]||(t[19]=a("span",null,"Menyimpan...",-1))],64)):(r(),u(w,{key:1},[i(n(W),{size:"18"}),a("span",null,v(c.value?"Update Status":"Simpan Status"),1)],64))],8,ja)])],32)])])):Q("",!0)]),_:1})]))}},Xa=I(Ea,[["__scopeId","data-v-bc2ebe47"]]);export{Xa as default};
