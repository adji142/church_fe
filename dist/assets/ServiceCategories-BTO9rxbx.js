import{_ as F,u as I,r as c,A as L,i as G,c as p,a as e,d as n,b as h,k as i,v as w,h as z,F as B,n as j,l as q,t as u,e as H,T as Q,j as f,o as d,q as R,x as X,w as K,m as M,y as Y}from"./index-Mv3MxCR1.js";import{S as g}from"./sweetalert2.esm.all-BQxta0Da.js";import{S as A}from"./search-DW_529iS.js";import{P as D}from"./plus-BF4bXWAK.js";import{C as J}from"./chevron-left-C_DfDUMJ.js";import{C as O}from"./chevron-right-u8dkcCrv.js";import{P as $,T as W}from"./trash-2-CXOSxmzs.js";import{X as Z,C as ee}from"./x-D8hPaNXE.js";import{T as ae}from"./type-zrf9LQ7g.js";import{F as te}from"./file-text-CPaFxqa6.js";import"./createLucideIcon-DBeZuCHW.js";const se={class:"master-data-page"},le={class:"header-section"},oe={class:"header-actions"},ie={class:"search-wrapper"},ne=["disabled"],re=["disabled"],de={class:"card table-card"},ue={key:0,class:"loading-state"},ce={key:1,class:"empty-state"},pe={class:"empty-icon"},ve={key:2,class:"table-container"},me={class:"modern-table"},ge={class:"order-badge"},he={class:"font-bold text-dark"},_e={class:"actions-group"},be=["onClick","disabled"],fe=["onClick","disabled"],ke={class:"pagination-footer"},ye={class:"per-page-selector"},Ce=["disabled"],xe={class:"pagination-controls"},we={class:"page-info"},Be={class:"page-buttons"},Te=["disabled"],Se=["disabled"],ze={class:"modal-content"},Ke={class:"modal-header"},Me={class:"header-icon"},Ae={class:"header-text"},De=["disabled"],$e={class:"form-section"},Ue={class:"form-group full-width"},Ve={class:"input-wrapper"},Ne=["disabled"],Pe={class:"form-group full-width",style:{"margin-top":"1rem"}},Ee={class:"input-wrapper"},Fe=["disabled"],Ie={class:"form-group full-width",style:{"margin-top":"1rem"}},Le={class:"checkbox-label"},Ge=["disabled"],je={class:"modal-footer"},qe=["disabled"],He=["disabled"],Qe={__name:"ServiceCategories",setup(Re){const _=I(),k=c([]),y=c(!0),s=c(!1),C=c(!1),v=c(null),x=c(""),T=c(null),l=c({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0}),r=c({name:"",description:"",is_active:!0,church_id:null}),m=async(o=1)=>{if(_.activeBranch){y.value=!0;try{const a=await f.get("/service-categories",{params:{church_id:_.activeBranch.id,page:o,per_page:l.value.per_page,search:x.value}});k.value=a.data.data,l.value={current_page:a.data.current_page,last_page:a.data.last_page,per_page:a.data.per_page,total:a.data.total,from:a.data.from,to:a.data.to}}catch(a){console.error("Failed to fetch categories",a),g.fire("Error","Gagal memuat data kategori.","error")}finally{y.value=!1}}},U=()=>{clearTimeout(T.value),T.value=setTimeout(()=>{m(1)},500)};L(()=>_.activeBranch,o=>{o&&m(1)},{immediate:!0}),G(()=>{m()});const S=(o=null)=>{o?(v.value=o.id,r.value={name:o.name,description:o.description,is_active:!!o.is_active,church_id:o.church_id}):(v.value=null,r.value={name:"",description:"",is_active:!0,church_id:_.activeBranch?.id}),C.value=!0},b=()=>{C.value=!1},V=async()=>{if(!r.value.church_id){g.fire("Error","Silakan pilih cabang/gereja terlebih dahulu.","error");return}s.value=!0;try{v.value?await f.put(`/service-categories/${v.value}`,r.value):await f.post("/service-categories",r.value),await m(l.value.current_page),b(),g.fire({icon:"success",title:"Berhasil!",text:"Data kategori telah diperbarui.",timer:2e3,showConfirmButton:!1})}catch{g.fire("Error","Gagal menyimpan data.","error")}finally{s.value=!1}},N=async o=>{if((await g.fire({title:"Apakah Anda yakin?",text:`Kategori "${o.name}" akan dihapus permanen!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed)try{await f.delete(`/service-categories/${o.id}`),await m(l.value.current_page),g.fire("Dihapus!","Data telah berhasil dihapus.","success")}catch{g.fire("Error","Gagal menghapus data.","error")}};return(o,a)=>(d(),p("div",se,[e("div",le,[a[12]||(a[12]=e("div",{class:"title-group"},[e("h1",{class:"page-title"},"Master Kategori Layanan"),e("p",{class:"page-subtitle"},"Kelola kategori layanan kerohanian (contoh: Sakramen, Pastoral)")],-1)),e("div",oe,[e("div",ie,[n(i(A),{size:"18",class:"search-icon"}),h(e("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>x.value=t),type:"text",placeholder:"Cari kategori...",class:"search-input",onInput:U,disabled:s.value},null,40,ne),[[w,x.value]])]),e("button",{class:"btn btn-primary",onClick:a[1]||(a[1]=t=>S()),disabled:s.value},[n(i(D),{size:"18"}),a[10]||(a[10]=z()),a[11]||(a[11]=e("span",null,"Tambah Kategori",-1))],8,re)])]),e("div",de,[y.value?(d(),p("div",ue,[...a[13]||(a[13]=[e("div",{class:"spinner"},null,-1),e("p",null,"Memuat data...",-1)])])):k.value.length===0?(d(),p("div",ce,[e("div",pe,[n(i(A),{size:"48"})]),a[14]||(a[14]=e("p",null,"Tidak ada data yang ditemukan.",-1))])):(d(),p("div",ve,[e("table",me,[a[15]||(a[15]=e("thead",null,[e("tr",null,[e("th",{style:{width:"80px"}},"No"),e("th",null,"Nama Kategori"),e("th",null,"Deskripsi"),e("th",null,"Status"),e("th",{class:"text-right"},"Aksi")])],-1)),e("tbody",null,[(d(!0),p(B,null,j(k.value,(t,P)=>(d(),p("tr",{key:t.id,class:"row-hover"},[e("td",null,[e("span",ge,u(l.value.from+P),1)]),e("td",he,u(t.name),1),e("td",null,u(t.description||"-"),1),e("td",null,[e("span",{class:R(["status-badge",t.is_active?"active":"inactive"])},u(t.is_active?"Aktif":"Tidak Aktif"),3)]),e("td",null,[e("div",_e,[e("button",{class:"action-btn edit",onClick:E=>S(t),title:"Ubah",disabled:s.value},[n(i($),{size:"16"})],8,be),e("button",{class:"action-btn delete",onClick:E=>N(t),title:"Hapus",disabled:s.value},[n(i(W),{size:"16"})],8,fe)])])]))),128))])]),e("div",ke,[e("div",ye,[a[17]||(a[17]=e("span",{class:"text-xs font-bold text-muted"},"TAMPILKAN",-1)),h(e("select",{"onUpdate:modelValue":a[2]||(a[2]=t=>l.value.per_page=t),onChange:a[3]||(a[3]=t=>m(1)),disabled:s.value},[...a[16]||(a[16]=[e("option",{value:10},"10 data",-1),e("option",{value:25},"25 data",-1),e("option",{value:50},"50 data",-1),e("option",{value:100},"100 data",-1)])],40,Ce),[[q,l.value.per_page]])]),e("div",xe,[e("span",we,[e("b",null,u(l.value.from||0)+"-"+u(l.value.to||0),1),a[18]||(a[18]=z(" dari ",-1)),e("b",null,u(l.value.total),1)]),e("div",Be,[e("button",{class:"page-btn",disabled:l.value.current_page===1||s.value,onClick:a[4]||(a[4]=t=>m(l.value.current_page-1))},[n(i(J),{size:"18"})],8,Te),e("button",{class:"page-btn",disabled:l.value.current_page===l.value.last_page||s.value,onClick:a[5]||(a[5]=t=>m(l.value.current_page+1))},[n(i(O),{size:"18"})],8,Se)])])])]))]),n(Q,{name:"modal-fade"},{default:H(()=>[C.value?(d(),p("div",{key:0,class:"modal-overlay",onClick:a[9]||(a[9]=K(t=>!s.value&&b(),["self"]))},[e("div",ze,[e("div",Ke,[e("div",Me,[v.value?(d(),M(i($),{key:1,size:"24"})):(d(),M(i(D),{key:0,size:"24"}))]),e("div",Ae,[e("h2",null,u(v.value?"Update Kategori":"Tambah Kategori Baru"),1),e("p",null,u(v.value?"Ubah informasi kategori layanan":"Buat kategori layanan baru"),1)]),e("button",{class:"close-btn",onClick:b,disabled:s.value},[n(i(Z),{size:"20"})],8,De)]),e("form",{onSubmit:K(V,["prevent"]),class:"modal-body"},[e("div",$e,[e("div",Ue,[a[19]||(a[19]=e("label",{class:"form-label"},"Nama Kategori",-1)),e("div",Ve,[n(i(ae),{size:"18",class:"input-icon"}),h(e("input",{"onUpdate:modelValue":a[6]||(a[6]=t=>r.value.name=t),type:"text",required:"",placeholder:"Contoh: Sakramen",disabled:s.value},null,8,Ne),[[w,r.value.name]])])]),e("div",Pe,[a[20]||(a[20]=e("label",{class:"form-label"},"Deskripsi",-1)),e("div",Ee,[n(i(te),{size:"18",class:"input-icon",style:{top:"1rem"}}),h(e("textarea",{"onUpdate:modelValue":a[7]||(a[7]=t=>r.value.description=t),rows:"3",placeholder:"Keterangan kategori...",disabled:s.value,class:"text-area-input"},null,8,Fe),[[w,r.value.description]])])]),e("div",Ie,[e("label",Le,[h(e("input",{type:"checkbox","onUpdate:modelValue":a[8]||(a[8]=t=>r.value.is_active=t),disabled:s.value},null,8,Ge),[[Y,r.value.is_active]]),a[21]||(a[21]=e("span",null,"Aktif",-1))])])]),e("div",je,[e("button",{type:"button",class:"btn btn-ghost",onClick:b,disabled:s.value},"Batal",8,qe),e("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:s.value},[s.value?(d(),p(B,{key:0},[a[22]||(a[22]=e("div",{class:"spinner small"},null,-1)),a[23]||(a[23]=e("span",null,"Menyimpan...",-1))],64)):(d(),p(B,{key:1},[n(i(ee),{size:"18"}),e("span",null,u(v.value?"Update Kategori":"Simpan Kategori"),1)],64))],8,He)])],32)])])):X("",!0)]),_:1})]))}},oa=F(Qe,[["__scopeId","data-v-f605fb6b"]]);export{oa as default};
