import{_ as I,u as F,r as d,A as G,i as K,c as u,a,d as i,b as C,k as n,v as T,h as P,F as x,n as L,l as H,t as v,e as O,T as q,j as f,o as r,x as Q,w as S,m as z}from"./index-Mv3MxCR1.js";import{S as b}from"./sweetalert2.esm.all-BQxta0Da.js";import{S as M}from"./search-DW_529iS.js";import{P as $}from"./plus-BF4bXWAK.js";import{C as R}from"./chevron-left-C_DfDUMJ.js";import{C as W}from"./chevron-right-u8dkcCrv.js";import{P as N,T as X}from"./trash-2-CXOSxmzs.js";import{X as Y,C as J}from"./x-D8hPaNXE.js";import{T as Z}from"./type-zrf9LQ7g.js";import"./createLucideIcon-DBeZuCHW.js";const aa={class:"master-data-page"},ea={class:"header-section"},ta={class:"header-actions"},sa={class:"search-wrapper"},la=["disabled"],oa=["disabled"],na={class:"card table-card"},ia={key:0,class:"loading-state"},ra={key:1,class:"empty-state"},da={class:"empty-icon"},ua={key:2,class:"table-container"},ca={class:"modern-table"},pa={class:"order-badge"},va={class:"font-bold text-dark"},ma={class:"actions-group"},ba=["onClick","disabled"],_a=["onClick","disabled"],ha={class:"pagination-footer"},fa={class:"per-page-selector"},ga=["disabled"],ka={class:"pagination-controls"},ya={class:"page-info"},wa={class:"page-buttons"},Ca=["disabled"],xa=["disabled"],ja={class:"modal-content"},Ba={class:"modal-header"},Ta={class:"header-icon"},Pa={class:"header-text"},Sa=["disabled"],za={class:"form-section"},Ma={class:"form-group full-width"},$a={class:"input-wrapper"},Na=["disabled"],Da={class:"modal-footer"},Aa=["disabled"],Ua=["disabled"],Va={__name:"Occupations",setup(Ea){const _=F(),g=d([]),k=d(!0),s=d(!1),y=d(!1),c=d(null),w=d(""),j=d(null),l=d({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0}),m=d({name:"",branch_id:null}),p=async(o=1)=>{if(_.activeBranch){k.value=!0;try{const e=await f.get("/occupations",{params:{branch_id:_.activeBranch.id,page:o,per_page:l.value.per_page,search:w.value}});g.value=e.data.data,l.value={current_page:e.data.current_page,last_page:e.data.last_page,per_page:e.data.per_page,total:e.data.total,from:e.data.from,to:e.data.to}}catch(e){console.error("Failed to fetch occupations",e),b.fire("Error","Gagal memuat data pekerjaan.","error")}finally{k.value=!1}}},D=()=>{clearTimeout(j.value),j.value=setTimeout(()=>{p(1)},500)};G(()=>_.activeBranch,o=>{o&&p(1)},{immediate:!0}),K(()=>{p()});const B=(o=null)=>{o?(c.value=o.id,m.value={name:o.name,branch_id:o.branch_id}):(c.value=null,m.value={name:"",branch_id:_.activeBranch?.id}),y.value=!0},h=()=>{y.value=!1},A=async()=>{if(!m.value.branch_id){b.fire("Error","Silakan pilih cabang terlebih dahulu.","error");return}s.value=!0;try{c.value?await f.put(`/occupations/${c.value}`,m.value):await f.post("/occupations",m.value),await p(l.value.current_page),h(),b.fire({icon:"success",title:"Berhasil!",text:"Data pekerjaan telah diperbarui.",timer:2e3,showConfirmButton:!1})}catch{b.fire("Error","Gagal menyimpan data.","error")}finally{s.value=!1}},U=async o=>{if((await b.fire({title:"Apakah Anda yakin?",text:`Pekerjaan "${o.name}" akan dihapus permanen!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed)try{await f.delete(`/occupations/${o.id}`),await p(l.value.current_page),b.fire("Dihapus!","Data telah berhasil dihapus.","success")}catch{b.fire("Error","Gagal menghapus data.","error")}};return(o,e)=>(r(),u("div",aa,[a("div",ea,[e[10]||(e[10]=a("div",{class:"title-group"},[a("h1",{class:"page-title"},"Master Pekerjaan"),a("p",{class:"page-subtitle"},"Kelola daftar pekerjaan jemaat di cabang ini")],-1)),a("div",ta,[a("div",sa,[i(n(M),{size:"18",class:"search-icon"}),C(a("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>w.value=t),type:"text",placeholder:"Cari pekerjaan...",class:"search-input",onInput:D,disabled:s.value},null,40,la),[[T,w.value]])]),a("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=t=>B()),disabled:s.value},[i(n($),{size:"18"}),e[8]||(e[8]=P()),e[9]||(e[9]=a("span",null,"Tambah Pekerjaan",-1))],8,oa)])]),a("div",na,[k.value?(r(),u("div",ia,[...e[11]||(e[11]=[a("div",{class:"spinner"},null,-1),a("p",null,"Memuat data...",-1)])])):g.value.length===0?(r(),u("div",ra,[a("div",da,[i(n(M),{size:"48"})]),e[12]||(e[12]=a("p",null,"Tidak ada data yang ditemukan.",-1))])):(r(),u("div",ua,[a("table",ca,[e[13]||(e[13]=a("thead",null,[a("tr",null,[a("th",{style:{width:"80px"}},"No"),a("th",null,"Nama Pekerjaan"),a("th",{class:"text-right"},"Aksi")])],-1)),a("tbody",null,[(r(!0),u(x,null,L(g.value,(t,V)=>(r(),u("tr",{key:t.id,class:"row-hover"},[a("td",null,[a("span",pa,v(l.value.from+V),1)]),a("td",va,v(t.name),1),a("td",null,[a("div",ma,[a("button",{class:"action-btn edit",onClick:E=>B(t),title:"Ubah",disabled:s.value},[i(n(N),{size:"16"})],8,ba),a("button",{class:"action-btn delete",onClick:E=>U(t),title:"Hapus",disabled:s.value},[i(n(X),{size:"16"})],8,_a)])])]))),128))])]),a("div",ha,[a("div",fa,[e[15]||(e[15]=a("span",{class:"text-xs font-bold text-muted"},"TAMPILKAN",-1)),C(a("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>l.value.per_page=t),onChange:e[3]||(e[3]=t=>p(1)),disabled:s.value},[...e[14]||(e[14]=[a("option",{value:10},"10 data",-1),a("option",{value:25},"25 data",-1),a("option",{value:50},"50 data",-1),a("option",{value:100},"100 data",-1)])],40,ga),[[H,l.value.per_page]])]),a("div",ka,[a("span",ya,[a("b",null,v(l.value.from||0)+"-"+v(l.value.to||0),1),e[16]||(e[16]=P(" dari ",-1)),a("b",null,v(l.value.total),1)]),a("div",wa,[a("button",{class:"page-btn",disabled:l.value.current_page===1||s.value,onClick:e[4]||(e[4]=t=>p(l.value.current_page-1))},[i(n(R),{size:"18"})],8,Ca),a("button",{class:"page-btn",disabled:l.value.current_page===l.value.last_page||s.value,onClick:e[5]||(e[5]=t=>p(l.value.current_page+1))},[i(n(W),{size:"18"})],8,xa)])])])]))]),i(q,{name:"modal-fade"},{default:O(()=>[y.value?(r(),u("div",{key:0,class:"modal-overlay",onClick:e[7]||(e[7]=S(t=>!s.value&&h(),["self"]))},[a("div",ja,[a("div",Ba,[a("div",Ta,[c.value?(r(),z(n(N),{key:1,size:"24"})):(r(),z(n($),{key:0,size:"24"}))]),a("div",Pa,[a("h2",null,v(c.value?"Update Pekerjaan":"Tambah Pekerjaan Baru"),1),a("p",null,v(c.value?"Ubah informasi pekerjaan yang sudah ada":"Masukkan nama pekerjaan baru"),1)]),a("button",{class:"close-btn",onClick:h,disabled:s.value},[i(n(Y),{size:"20"})],8,Sa)]),a("form",{onSubmit:S(A,["prevent"]),class:"modal-body"},[a("div",za,[a("div",Ma,[e[17]||(e[17]=a("label",{class:"form-label"},"Nama Pekerjaan",-1)),a("div",$a,[i(n(Z),{size:"18",class:"input-icon"}),C(a("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>m.value.name=t),type:"text",required:"",placeholder:"Contoh: PNS, Karyawan Swasta, Wiraswasta, dll.",disabled:s.value},null,8,Na),[[T,m.value.name]])])])]),a("div",Da,[a("button",{type:"button",class:"btn btn-ghost",onClick:h,disabled:s.value},"Batal",8,Aa),a("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:s.value},[s.value?(r(),u(x,{key:0},[e[18]||(e[18]=a("div",{class:"spinner small"},null,-1)),e[19]||(e[19]=a("span",null,"Menyimpan...",-1))],64)):(r(),u(x,{key:1},[i(n(J),{size:"18"}),a("span",null,v(c.value?"Update Pekerjaan":"Simpan Pekerjaan"),1)],64))],8,Ua)])],32)])])):Q("",!0)]),_:1})]))}},Wa=I(Va,[["__scopeId","data-v-04d63c26"]]);export{Wa as default};
