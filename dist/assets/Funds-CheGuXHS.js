import{_ as j,u as q,r as c,i as E,c as p,a,d as i,b,k as n,v as w,h as x,F as D,n as G,l as H,t as r,e as K,T as Q,j as h,o as d,q as B,x as R,w as M,m as N}from"./index-Mv3MxCR1.js";import{S as f}from"./sweetalert2.esm.all-BQxta0Da.js";import{S as X}from"./search-DW_529iS.js";import{P as A}from"./plus-BF4bXWAK.js";import{B as U}from"./briefcase-DeOdw5oH.js";import{C as Y}from"./chevron-left-C_DfDUMJ.js";import{C as J}from"./chevron-right-u8dkcCrv.js";import{P as V,T as O}from"./trash-2-CXOSxmzs.js";import{X as W,C as Z}from"./x-D8hPaNXE.js";import"./createLucideIcon-DBeZuCHW.js";const aa={class:"master-data-page wide"},ta={class:"header-section"},ea={class:"header-actions"},sa={class:"search-wrapper"},la={class:"card table-card"},na={key:0,class:"loading-state"},oa={key:1,class:"empty-state"},ia={class:"empty-icon"},da={key:2,class:"table-container"},ra={class:"modern-table"},ua={class:"name-column"},ca={class:"font-bold text-dark"},pa={class:"text-xs text-muted"},va={class:"code-badge"},ma={class:"actions-group"},fa=["onClick"],_a=["onClick"],ba={class:"pagination-footer"},ha={class:"per-page-selector"},ga={class:"pagination-controls"},ka={class:"page-info"},ya={class:"page-buttons"},Ca=["disabled"],wa=["disabled"],xa={class:"modal-content"},Da={class:"modal-header"},Ba={class:"header-icon"},Ta={class:"header-text"},za=["disabled"],Sa={class:"form-grid"},$a={class:"form-group full-width"},Ma={class:"input-wrapper"},Na=["disabled"],Aa={class:"form-group full-width"},Ua={class:"status-toggle-group"},Va=["disabled"],Fa=["disabled"],Ia={class:"form-group full-width"},Pa={class:"input-wrapper"},La=["disabled"],ja={class:"modal-footer"},qa=["disabled"],Ea=["disabled"],Ga={__name:"Funds",setup(Ha){const T=q(),g=c([]),k=c(!0),o=c(!1),y=c(!1),v=c(null),C=c(""),z=c(null),s=c({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0}),S=()=>({church_id:T.activeBranch,name:"",description:"",is_active:!0}),l=c(S()),m=async(u=1)=>{k.value=!0;try{const t=await h.get("/funds",{params:{page:u,per_page:s.value.per_page,search:C.value,church_id:T.activeBranch}});g.value=t.data.data,s.value={current_page:t.data.current_page,last_page:t.data.last_page,per_page:t.data.per_page,total:t.data.total,from:t.data.from,to:t.data.to}}catch(t){console.error("Fetch error:",t)}finally{k.value=!1}},F=()=>{clearTimeout(z.value),z.value=setTimeout(()=>m(1),500)},$=(u=null)=>{u?(v.value=u.id,l.value={...u}):(v.value=null,l.value=S()),y.value=!0},_=()=>{y.value=!1},I=async()=>{o.value=!0;try{v.value?await h.put(`/funds/${v.value}`,l.value):await h.post("/funds",l.value),f.fire({icon:"success",title:"Berhasil",timer:2e3,showConfirmButton:!1}),m(s.value.current_page),_()}catch{f.fire("Error","Gagal menyimpan data","error")}finally{o.value=!1}},P=async u=>{if((await f.fire({title:"Hapus Dana?",text:"Data yang dihapus tidak dapat dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",confirmButtonText:"Ya, Hapus"})).isConfirmed)try{await h.delete(`/funds/${u.id}`),m(),f.fire("Terhapus!","Dana telah dihapus.","success")}catch{f.fire("Error","Gagal menghapus data","error")}};return E(()=>{m()}),(u,t)=>(d(),p("div",aa,[a("div",ta,[t[13]||(t[13]=a("div",{class:"title-group"},[a("h1",{class:"page-title"},"Dana Gereja"),a("p",{class:"page-subtitle"},"Kelola alokasi dana dan sumber pendanaan pelayanan")],-1)),a("div",ea,[a("div",sa,[i(n(X),{size:"18",class:"search-icon"}),b(a("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>C.value=e),type:"text",placeholder:"Cari dana...",class:"search-input",onInput:F},null,544),[[w,C.value]])]),a("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=e=>$())},[i(n(A),{size:"18"}),t[11]||(t[11]=x()),t[12]||(t[12]=a("span",null,"Tambah Dana",-1))])])]),a("div",la,[k.value?(d(),p("div",na,[...t[14]||(t[14]=[a("div",{class:"spinner"},null,-1),a("p",null,"Memuat data dana...",-1)])])):g.value.length===0?(d(),p("div",oa,[a("div",ia,[i(n(U),{size:"48"})]),t[15]||(t[15]=a("p",null,"Tidak ada dana ditemukan.",-1))])):(d(),p("div",da,[a("table",ra,[t[16]||(t[16]=a("thead",null,[a("tr",null,[a("th",{style:{width:"250px"}},"Nama Dana"),a("th",null,"Kode"),a("th",null,"Status"),a("th",{class:"text-right"},"Aksi")])],-1)),a("tbody",null,[(d(!0),p(D,null,G(g.value,e=>(d(),p("tr",{key:e.id,class:"row-hover"},[a("td",null,[a("div",ua,[a("span",ca,r(e.name),1),a("span",pa,"ID: #"+r(e.id),1)])]),a("td",null,[a("span",va,r(e.code),1)]),a("td",null,[a("span",{class:B(["status-pill",e.is_active?"active":"inactive"])},r(e.is_active?"Aktif":"Non-Aktif"),3)]),a("td",null,[a("div",ma,[a("button",{class:"action-btn edit",onClick:L=>$(e),title:"Ubah"},[i(n(V),{size:"16"})],8,fa),a("button",{class:"action-btn delete",onClick:L=>P(e),title:"Hapus"},[i(n(O),{size:"16"})],8,_a)])])]))),128))])]),a("div",ba,[a("div",ha,[t[18]||(t[18]=a("span",{class:"text-xs font-bold text-muted"},"TAMPILKAN",-1)),b(a("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>s.value.per_page=e),onChange:t[3]||(t[3]=e=>m(1))},[...t[17]||(t[17]=[a("option",{value:10},"10 data",-1),a("option",{value:25},"25 data",-1),a("option",{value:50},"50 data",-1)])],544),[[H,s.value.per_page]])]),a("div",ga,[a("span",ka,[a("b",null,r(s.value.from||0)+"-"+r(s.value.to||0),1),t[19]||(t[19]=x(" dari ",-1)),a("b",null,r(s.value.total),1)]),a("div",ya,[a("button",{class:"page-btn",disabled:s.value.current_page===1,onClick:t[4]||(t[4]=e=>m(s.value.current_page-1))},[i(n(Y),{size:"18"})],8,Ca),a("button",{class:"page-btn",disabled:s.value.current_page===s.value.last_page,onClick:t[5]||(t[5]=e=>m(s.value.current_page+1))},[i(n(J),{size:"18"})],8,wa)])])])]))]),i(Q,{name:"modal-fade"},{default:K(()=>[y.value?(d(),p("div",{key:0,class:"modal-overlay",onClick:t[10]||(t[10]=M(e=>!o.value&&_(),["self"]))},[a("div",xa,[a("div",Da,[a("div",Ba,[v.value?(d(),N(n(V),{key:1,size:"24"})):(d(),N(n(A),{key:0,size:"24"}))]),a("div",Ta,[a("h2",null,r(v.value?"Update Dana":"Tambah Dana Baru"),1),a("p",null,r(v.value?"Ubah informasi dana yang sudah ada":"Lengkapi informasi dana gereja di bawah ini"),1)]),a("button",{class:"close-btn",onClick:_,disabled:o.value},[i(n(W),{size:"20"})],8,za)]),a("form",{onSubmit:M(I,["prevent"]),class:"modal-body"},[a("div",Sa,[a("div",$a,[t[20]||(t[20]=a("label",{class:"form-label"},[x("Nama Dana "),a("span",{class:"required"},"*")],-1)),a("div",Ma,[i(n(U),{size:"18",class:"input-icon"}),b(a("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>l.value.name=e),type:"text",required:"",placeholder:"Contoh: Dana Pembangunan",disabled:o.value},null,8,Na),[[w,l.value.name]])])]),a("div",Aa,[t[21]||(t[21]=a("label",{class:"form-label"},"Status Dana",-1)),a("div",Ua,[a("button",{type:"button",class:B(["status-btn",{active:l.value.is_active}]),onClick:t[7]||(t[7]=e=>l.value.is_active=!0),disabled:o.value},"Aktif",10,Va),a("button",{type:"button",class:B(["status-btn",{active:!l.value.is_active}]),onClick:t[8]||(t[8]=e=>l.value.is_active=!1),disabled:o.value},"Non-Aktif",10,Fa)])]),a("div",Ia,[t[22]||(t[22]=a("label",{class:"form-label"},"Deskripsi / Catatan",-1)),a("div",Pa,[b(a("textarea",{"onUpdate:modelValue":t[9]||(t[9]=e=>l.value.description=e),rows:"3",placeholder:"Informasi tambahan mengenai dana ini...",disabled:o.value},null,8,La),[[w,l.value.description]])])])]),a("div",ja,[a("button",{type:"button",class:"btn btn-ghost",onClick:_,disabled:o.value},"Batal",8,qa),a("button",{type:"submit",class:"btn btn-primary",disabled:o.value},[o.value?(d(),p(D,{key:0},[t[23]||(t[23]=a("div",{class:"spinner small"},null,-1)),t[24]||(t[24]=a("span",null,"Menyimpan...",-1))],64)):(d(),p(D,{key:1},[i(n(Z),{size:"18"}),a("span",null,r(v.value?"Update Data":"Simpan Dana"),1)],64))],8,Ea)])],32)])])):R("",!0)]),_:1})]))}},tt=j(Ga,[["__scopeId","data-v-729ae34f"]]);export{tt as default};
