import{_ as E,u as j,r as d,A as F,i as G,c as u,a,d as i,b as C,k as n,v as T,h as z,F as x,n as L,l as H,t as v,e as K,T as q,j as f,o as r,x as J,w as S,m as W}from"./index-Mv3MxCR1.js";import{S as m}from"./sweetalert2.esm.all-BQxta0Da.js";import{S as $}from"./search-DW_529iS.js";import{P as A}from"./plus-BF4bXWAK.js";import{C as Q}from"./chevron-left-C_DfDUMJ.js";import{C as R}from"./chevron-right-u8dkcCrv.js";import{P as D,T as X}from"./trash-2-CXOSxmzs.js";import{X as Y,C as O}from"./x-D8hPaNXE.js";import{M as Z}from"./map-pin-DIz-n_0r.js";import"./createLucideIcon-DBeZuCHW.js";const aa={class:"master-data-page"},ea={class:"header-section"},ta={class:"header-actions"},sa={class:"search-wrapper"},la=["disabled"],oa=["disabled"],na={class:"card table-card"},ia={key:0,class:"loading-state"},ra={key:1,class:"empty-state"},da={class:"empty-icon"},ua={key:2,class:"table-container"},ca={class:"modern-table"},pa={class:"order-badge"},va={class:"font-bold text-dark"},ha={class:"actions-group"},ma=["onClick","disabled"],ba=["onClick","disabled"],_a={class:"pagination-footer"},fa={class:"per-page-selector"},ga=["disabled"],ya={class:"pagination-controls"},ka={class:"page-info"},wa={class:"page-buttons"},Ca=["disabled"],xa=["disabled"],Ba={class:"modal-content"},Ma={class:"modal-header"},Ta={class:"header-icon"},za={class:"header-text"},Sa=["disabled"],Wa={class:"form-section"},$a={class:"form-group full-width"},Aa={class:"input-wrapper"},Da=["disabled"],Na={class:"modal-footer"},Ia=["disabled"],Ua=["disabled"],Va={__name:"ChurchAreas",setup(Pa){const b=j(),g=d([]),y=d(!0),s=d(!1),k=d(!1),c=d(null),w=d(""),B=d(null),l=d({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0}),h=d({name:"",branch_id:null}),p=async(o=1)=>{if(b.activeBranch){y.value=!0;try{const e=await f.get("/church-areas",{params:{branch_id:b.activeBranch.id,page:o,per_page:l.value.per_page,search:w.value}});g.value=e.data.data,l.value={current_page:e.data.current_page,last_page:e.data.last_page,per_page:e.data.per_page,total:e.data.total,from:e.data.from,to:e.data.to}}catch(e){console.error("Failed to fetch church areas",e),m.fire("Error","Gagal memuat data wilayah jemaat.","error")}finally{y.value=!1}}},N=()=>{clearTimeout(B.value),B.value=setTimeout(()=>{p(1)},500)};F(()=>b.activeBranch,o=>{o&&p(1)},{immediate:!0}),G(()=>{p()});const M=(o=null)=>{o?(c.value=o.id,h.value={name:o.name,branch_id:o.branch_id}):(c.value=null,h.value={name:"",branch_id:b.activeBranch?.id}),k.value=!0},_=()=>{k.value=!1},I=async()=>{if(!h.value.branch_id){m.fire("Error","Silakan pilih cabang terlebih dahulu.","error");return}s.value=!0;try{c.value?await f.put(`/church-areas/${c.value}`,h.value):await f.post("/church-areas",h.value),await p(l.value.current_page),_(),m.fire({icon:"success",title:"Berhasil!",text:"Data wilayah jemaat telah diperbarui.",timer:2e3,showConfirmButton:!1})}catch{m.fire("Error","Gagal menyimpan data.","error")}finally{s.value=!1}},U=async o=>{if((await m.fire({title:"Apakah Anda yakin?",text:`Wilayah "${o.name}" akan dihapus permanen!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed)try{await f.delete(`/church-areas/${o.id}`),await p(l.value.current_page),m.fire("Dihapus!","Data telah berhasil dihapus.","success")}catch{m.fire("Error","Gagal menghapus data.","error")}};return(o,e)=>(r(),u("div",aa,[a("div",ea,[e[10]||(e[10]=a("div",{class:"title-group"},[a("h1",{class:"page-title"},"Master Wilayah Jemaat"),a("p",{class:"page-subtitle"},"Kelola daftar wilayah jemaat di cabang ini")],-1)),a("div",ta,[a("div",sa,[i(n($),{size:"18",class:"search-icon"}),C(a("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>w.value=t),type:"text",placeholder:"Cari wilayah...",class:"search-input",onInput:N,disabled:s.value},null,40,la),[[T,w.value]])]),a("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=t=>M()),disabled:s.value},[i(n(A),{size:"18"}),e[8]||(e[8]=z()),e[9]||(e[9]=a("span",null,"Tambah Wilayah",-1))],8,oa)])]),a("div",na,[y.value?(r(),u("div",ia,[...e[11]||(e[11]=[a("div",{class:"spinner"},null,-1),a("p",null,"Memuat data...",-1)])])):g.value.length===0?(r(),u("div",ra,[a("div",da,[i(n($),{size:"48"})]),e[12]||(e[12]=a("p",null,"Tidak ada data yang ditemukan.",-1))])):(r(),u("div",ua,[a("table",ca,[e[13]||(e[13]=a("thead",null,[a("tr",null,[a("th",{style:{width:"80px"}},"No"),a("th",null,"Nama Wilayah"),a("th",{class:"text-right"},"Aksi")])],-1)),a("tbody",null,[(r(!0),u(x,null,L(g.value,(t,V)=>(r(),u("tr",{key:t.id,class:"row-hover"},[a("td",null,[a("span",pa,v(l.value.from+V),1)]),a("td",va,v(t.name),1),a("td",null,[a("div",ha,[a("button",{class:"action-btn edit",onClick:P=>M(t),title:"Ubah",disabled:s.value},[i(n(D),{size:"16"})],8,ma),a("button",{class:"action-btn delete",onClick:P=>U(t),title:"Hapus",disabled:s.value},[i(n(X),{size:"16"})],8,ba)])])]))),128))])]),a("div",_a,[a("div",fa,[e[15]||(e[15]=a("span",{class:"text-xs font-bold text-muted"},"TAMPILKAN",-1)),C(a("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>l.value.per_page=t),onChange:e[3]||(e[3]=t=>p(1)),disabled:s.value},[...e[14]||(e[14]=[a("option",{value:10},"10 data",-1),a("option",{value:25},"25 data",-1),a("option",{value:50},"50 data",-1),a("option",{value:100},"100 data",-1)])],40,ga),[[H,l.value.per_page]])]),a("div",ya,[a("span",ka,[a("b",null,v(l.value.from||0)+"-"+v(l.value.to||0),1),e[16]||(e[16]=z(" dari ",-1)),a("b",null,v(l.value.total),1)]),a("div",wa,[a("button",{class:"page-btn",disabled:l.value.current_page===1||s.value,onClick:e[4]||(e[4]=t=>p(l.value.current_page-1))},[i(n(Q),{size:"18"})],8,Ca),a("button",{class:"page-btn",disabled:l.value.current_page===l.value.last_page||s.value,onClick:e[5]||(e[5]=t=>p(l.value.current_page+1))},[i(n(R),{size:"18"})],8,xa)])])])]))]),i(q,{name:"modal-fade"},{default:K(()=>[k.value?(r(),u("div",{key:0,class:"modal-overlay",onClick:e[7]||(e[7]=S(t=>!s.value&&_(),["self"]))},[a("div",Ba,[a("div",Ma,[a("div",Ta,[c.value?(r(),W(n(D),{key:1,size:"24"})):(r(),W(n(A),{key:0,size:"24"}))]),a("div",za,[a("h2",null,v(c.value?"Update Wilayah":"Tambah Wilayah Baru"),1),a("p",null,v(c.value?"Ubah informasi wilayah yang sudah ada":"Masukkan nama wilayah baru"),1)]),a("button",{class:"close-btn",onClick:_,disabled:s.value},[i(n(Y),{size:"20"})],8,Sa)]),a("form",{onSubmit:S(I,["prevent"]),class:"modal-body"},[a("div",Wa,[a("div",$a,[e[17]||(e[17]=a("label",{class:"form-label"},"Nama Wilayah",-1)),a("div",Aa,[i(n(Z),{size:"18",class:"input-icon"}),C(a("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>h.value.name=t),type:"text",required:"",placeholder:"Contoh: Wilayah I, Wilayah II, dll.",disabled:s.value},null,8,Da),[[T,h.value.name]])])])]),a("div",Na,[a("button",{type:"button",class:"btn btn-ghost",onClick:_,disabled:s.value},"Batal",8,Ia),a("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:s.value},[s.value?(r(),u(x,{key:0},[e[18]||(e[18]=a("div",{class:"spinner small"},null,-1)),e[19]||(e[19]=a("span",null,"Menyimpan...",-1))],64)):(r(),u(x,{key:1},[i(n(O),{size:"18"}),a("span",null,v(c.value?"Update Wilayah":"Simpan Wilayah"),1)],64))],8,Ua)])],32)])])):J("",!0)]),_:1})]))}},Ra=E(Va,[["__scopeId","data-v-ecbe2118"]]);export{Ra as default};
