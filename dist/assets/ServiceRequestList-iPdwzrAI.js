import{_ as z,u as B,r as c,A as T,i as A,c as i,a as e,d as r,b as y,k as d,v as M,h as b,F as k,n as x,l as F,t as n,j as I,g as P,o as u,q as D}from"./index-Mv3MxCR1.js";import{S as V}from"./search-DW_529iS.js";import{P as $}from"./plus-BF4bXWAK.js";import{F as E}from"./file-text-CPaFxqa6.js";import{C as J}from"./chevron-left-C_DfDUMJ.js";import{C as K}from"./chevron-right-u8dkcCrv.js";import{C as U}from"./calendar-COvuOzBD.js";import{E as Q}from"./eye-BCGuvWcX.js";import"./createLucideIcon-DBeZuCHW.js";const Y={class:"master-data-page"},G={class:"header-section"},H={class:"header-actions"},O={class:"search-wrapper"},W={class:"filter-tab-container"},X={class:"filter-tabs"},Z=["onClick"],ee={class:"card table-card"},te={key:0,class:"loading-state"},ae={key:1,class:"empty-state"},se={class:"empty-icon"},le={key:2,class:"table-container"},ne={class:"modern-table"},oe={class:"font-mono font-bold text-indigo"},ie={class:"font-bold text-dark"},re={class:"text-xs text-muted"},de={class:"font-bold text-dark"},ue={class:"category-tag"},ce={class:"date-display"},pe={class:"actions-group"},ve=["onClick"],_e={class:"pagination-footer"},me={class:"per-page-selector"},ge={class:"pagination-controls"},be={class:"page-info"},he={class:"page-buttons"},fe=["disabled"],ye=["disabled"],ke={__name:"ServiceRequestList",setup(xe){const p=B(),h=P(),v=c([]),_=c(!0),m=c(""),g=c(""),f=c(null),C=[{value:"",label:"Semua"},{value:"pending",label:"Menunggu"},{value:"approved",label:"Disetujui"},{value:"scheduled",label:"Dijadwalkan"},{value:"completed",label:"Selesai"},{value:"rejected",label:"Ditolak"},{value:"cancelled",label:"Dibatalkan"}],l=c({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0}),o=async(s=1)=>{if(p.activeBranch){_.value=!0;try{const t=await I.get("/service-requests",{params:{church_id:p.activeBranch.id,page:s,per_page:l.value.per_page,search:m.value,status:g.value}});v.value=t.data.data,l.value={current_page:t.data.current_page,last_page:t.data.last_page,per_page:t.data.per_page,total:t.data.total,from:t.data.from,to:t.data.to}}catch(t){console.error("Fetch error",t)}finally{_.value=!1}}},S=()=>{clearTimeout(f.value),f.value=setTimeout(()=>{o(1)},500)},q=s=>{g.value=s,o(1)},w=()=>{h.push({name:"CreateServiceRequest"})},N=s=>{h.push({name:"ServiceRequestDetail",params:{id:s.id}})},L=s=>{if(!s)return"-";const t=new Date(s);return isNaN(t)?s:t.toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"})},R=s=>({pending:"Menunggu",approved:"Disetujui",rejected:"Ditolak",scheduled:"Dijadwalkan",completed:"Selesai",cancelled:"Dibatalkan"})[s]||s;return T(()=>p.activeBranch,()=>o(1),{immediate:!0}),A(()=>{o()}),(s,t)=>(u(),i("div",Y,[e("div",G,[t[7]||(t[7]=e("div",{class:"title-group"},[e("h1",{class:"page-title"},"Permintaan Layanan"),e("p",{class:"page-subtitle"},"Kelola permintaan layanan, approval, dan penjadwalan jemaat")],-1)),e("div",H,[e("div",O,[r(d(V),{size:"18",class:"search-icon"}),y(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>m.value=a),type:"text",placeholder:"Cari No. Request / Nama Jemaat...",class:"search-input",onInput:S},null,544),[[M,m.value]])]),e("button",{class:"btn btn-primary",onClick:w},[r(d($),{size:"18"}),t[5]||(t[5]=b()),t[6]||(t[6]=e("span",null,"Buat Permintaan",-1))])])]),e("div",W,[e("div",X,[(u(),i(k,null,x(C,a=>e("button",{key:a.value,class:D(["tab-btn",g.value===a.value?"active":""]),onClick:j=>q(a.value)},n(a.label),11,Z)),64))])]),e("div",ee,[_.value?(u(),i("div",te,[...t[8]||(t[8]=[e("div",{class:"spinner"},null,-1),e("p",null,"Memuat data...",-1)])])):v.value.length===0?(u(),i("div",ae,[e("div",se,[r(d(E),{size:"48"})]),t[9]||(t[9]=e("p",null,"Tidak ada permintaan layanan ditemukan.",-1))])):(u(),i("div",le,[e("table",ne,[t[10]||(t[10]=e("thead",null,[e("tr",null,[e("th",{style:{width:"140px"}},"No. Request"),e("th",null,"Jemaat"),e("th",null,"Layanan"),e("th",null,"Tanggal Request"),e("th",null,"Status"),e("th",{class:"text-right"},"Aksi")])],-1)),e("tbody",null,[(u(!0),i(k,null,x(v.value,a=>(u(),i("tr",{key:a.id,class:"row-hover"},[e("td",null,[e("span",oe,n(a.request_number),1)]),e("td",null,[e("div",ie,n(a.member?.nama_lengkap),1),e("div",re,n(a.member?.no_hp||"-"),1)]),e("td",null,[e("div",de,n(a.service_type?.name),1),e("div",ue,n(a.service_type?.category?.name||"LAINNYA"),1)]),e("td",null,[e("div",ce,[r(d(U),{size:"14",class:"mr-1"}),b(" "+n(L(a.requested_at)),1)])]),e("td",null,[e("span",{class:D(["status-badge","tr-"+a.status])},n(R(a.status)),3)]),e("td",null,[e("div",pe,[e("button",{class:"action-btn view",onClick:j=>N(a),title:"Lihat Detail"},[r(d(Q),{size:"16"})],8,ve)])])]))),128))])]),e("div",_e,[e("div",me,[t[12]||(t[12]=e("span",{class:"text-xs font-bold text-muted"},"TAMPILKAN",-1)),y(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>l.value.per_page=a),onChange:t[2]||(t[2]=a=>o(1))},[...t[11]||(t[11]=[e("option",{value:10},"10 data",-1),e("option",{value:25},"25 data",-1),e("option",{value:50},"50 data",-1),e("option",{value:100},"100 data",-1)])],544),[[F,l.value.per_page]])]),e("div",ge,[e("span",be,[e("b",null,n(l.value.from||0)+"-"+n(l.value.to||0),1),t[13]||(t[13]=b(" dari ",-1)),e("b",null,n(l.value.total),1)]),e("div",he,[e("button",{class:"page-btn",disabled:l.value.current_page===1,onClick:t[3]||(t[3]=a=>o(l.value.current_page-1))},[r(d(J),{size:"18"})],8,fe),e("button",{class:"page-btn",disabled:l.value.current_page===l.value.last_page,onClick:t[4]||(t[4]=a=>o(l.value.current_page+1))},[r(d(K),{size:"18"})],8,ye)])])])]))])]))}},ze=z(ke,[["__scopeId","data-v-f08b28ad"]]);export{ze as default};
