import{_ as I,u as F,r,A as G,i as L,c as u,a,d as i,b as w,k as o,v as P,h as S,F as x,n as H,l as J,t as v,e as K,T as q,j as f,o as d,x as Q,w as M,m as z}from"./index-Mv3MxCR1.js";import{S as b}from"./sweetalert2.esm.all-BQxta0Da.js";import{S as $}from"./search-DW_529iS.js";import{P as j}from"./plus-BF4bXWAK.js";import{C as R}from"./chevron-left-C_DfDUMJ.js";import{C as X}from"./chevron-right-u8dkcCrv.js";import{P as D,T as Y}from"./trash-2-CXOSxmzs.js";import{X as O,C as W}from"./x-D8hPaNXE.js";import{T as Z}from"./type-zrf9LQ7g.js";import"./createLucideIcon-DBeZuCHW.js";const aa={class:"master-data-page"},ea={class:"header-section"},ta={class:"header-actions"},sa={class:"search-wrapper"},na=["disabled"],la=["disabled"],oa={class:"card table-card"},ia={key:0,class:"loading-state"},da={key:1,class:"empty-state"},ra={class:"empty-icon"},ua={key:2,class:"table-container"},ca={class:"modern-table"},pa={class:"order-badge"},va={class:"font-bold text-dark"},ma={class:"actions-group"},ba=["onClick","disabled"],_a=["onClick","disabled"],ha={class:"pagination-footer"},fa={class:"per-page-selector"},ga=["disabled"],ka={class:"pagination-controls"},ya={class:"page-info"},Ca={class:"page-buttons"},wa=["disabled"],xa=["disabled"],Ba={class:"modal-content"},Ta={class:"modal-header"},Pa={class:"header-icon"},Sa={class:"header-text"},Ma=["disabled"],za={class:"form-section"},$a={class:"form-group full-width"},ja={class:"input-wrapper"},Da=["disabled"],Aa={class:"modal-footer"},Ea=["disabled"],Ua=["disabled"],Va={__name:"Educations",setup(Na){const _=F(),g=r([]),k=r(!0),s=r(!1),y=r(!1),c=r(null),C=r(""),B=r(null),n=r({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0}),m=r({name:"",branch_id:null}),p=async(l=1)=>{if(_.activeBranch){k.value=!0;try{const e=await f.get("/educations",{params:{branch_id:_.activeBranch.id,page:l,per_page:n.value.per_page,search:C.value}});g.value=e.data.data,n.value={current_page:e.data.current_page,last_page:e.data.last_page,per_page:e.data.per_page,total:e.data.total,from:e.data.from,to:e.data.to}}catch(e){console.error("Failed to fetch educations",e),b.fire("Error","Gagal memuat data pendidikan.","error")}finally{k.value=!1}}},A=()=>{clearTimeout(B.value),B.value=setTimeout(()=>{p(1)},500)};G(()=>_.activeBranch,l=>{l&&p(1)},{immediate:!0}),L(()=>{p()});const T=(l=null)=>{l?(c.value=l.id,m.value={name:l.name,branch_id:l.branch_id}):(c.value=null,m.value={name:"",branch_id:_.activeBranch?.id}),y.value=!0},h=()=>{y.value=!1},E=async()=>{if(!m.value.branch_id){b.fire("Error","Silakan pilih cabang terlebih dahulu.","error");return}s.value=!0;try{c.value?await f.put(`/educations/${c.value}`,m.value):await f.post("/educations",m.value),await p(n.value.current_page),h(),b.fire({icon:"success",title:"Berhasil!",text:"Data pendidikan telah diperbarui.",timer:2e3,showConfirmButton:!1})}catch{b.fire("Error","Gagal menyimpan data.","error")}finally{s.value=!1}},U=async l=>{if((await b.fire({title:"Apakah Anda yakin?",text:`Pendidikan "${l.name}" akan dihapus permanen!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed)try{await f.delete(`/educations/${l.id}`),await p(n.value.current_page),b.fire("Dihapus!","Data telah berhasil dihapus.","success")}catch{b.fire("Error","Gagal menghapus data.","error")}};return(l,e)=>(d(),u("div",aa,[a("div",ea,[e[10]||(e[10]=a("div",{class:"title-group"},[a("h1",{class:"page-title"},"Master Pendidikan"),a("p",{class:"page-subtitle"},"Kelola daftar jenjang pendidikan di cabang ini")],-1)),a("div",ta,[a("div",sa,[i(o($),{size:"18",class:"search-icon"}),w(a("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>C.value=t),type:"text",placeholder:"Cari pendidikan...",class:"search-input",onInput:A,disabled:s.value},null,40,na),[[P,C.value]])]),a("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=t=>T()),disabled:s.value},[i(o(j),{size:"18"}),e[8]||(e[8]=S()),e[9]||(e[9]=a("span",null,"Tambah Pendidikan",-1))],8,la)])]),a("div",oa,[k.value?(d(),u("div",ia,[...e[11]||(e[11]=[a("div",{class:"spinner"},null,-1),a("p",null,"Memuat data...",-1)])])):g.value.length===0?(d(),u("div",da,[a("div",ra,[i(o($),{size:"48"})]),e[12]||(e[12]=a("p",null,"Tidak ada data yang ditemukan.",-1))])):(d(),u("div",ua,[a("table",ca,[e[13]||(e[13]=a("thead",null,[a("tr",null,[a("th",{style:{width:"80px"}},"No"),a("th",null,"Jenjang Pendidikan"),a("th",{class:"text-right"},"Aksi")])],-1)),a("tbody",null,[(d(!0),u(x,null,H(g.value,(t,V)=>(d(),u("tr",{key:t.id,class:"row-hover"},[a("td",null,[a("span",pa,v(n.value.from+V),1)]),a("td",va,v(t.name),1),a("td",null,[a("div",ma,[a("button",{class:"action-btn edit",onClick:N=>T(t),title:"Ubah",disabled:s.value},[i(o(D),{size:"16"})],8,ba),a("button",{class:"action-btn delete",onClick:N=>U(t),title:"Hapus",disabled:s.value},[i(o(Y),{size:"16"})],8,_a)])])]))),128))])]),a("div",ha,[a("div",fa,[e[15]||(e[15]=a("span",{class:"text-xs font-bold text-muted"},"TAMPILKAN",-1)),w(a("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.per_page=t),onChange:e[3]||(e[3]=t=>p(1)),disabled:s.value},[...e[14]||(e[14]=[a("option",{value:10},"10 data",-1),a("option",{value:25},"25 data",-1),a("option",{value:50},"50 data",-1),a("option",{value:100},"100 data",-1)])],40,ga),[[J,n.value.per_page]])]),a("div",ka,[a("span",ya,[a("b",null,v(n.value.from||0)+"-"+v(n.value.to||0),1),e[16]||(e[16]=S(" dari ",-1)),a("b",null,v(n.value.total),1)]),a("div",Ca,[a("button",{class:"page-btn",disabled:n.value.current_page===1||s.value,onClick:e[4]||(e[4]=t=>p(n.value.current_page-1))},[i(o(R),{size:"18"})],8,wa),a("button",{class:"page-btn",disabled:n.value.current_page===n.value.last_page||s.value,onClick:e[5]||(e[5]=t=>p(n.value.current_page+1))},[i(o(X),{size:"18"})],8,xa)])])])]))]),i(q,{name:"modal-fade"},{default:K(()=>[y.value?(d(),u("div",{key:0,class:"modal-overlay",onClick:e[7]||(e[7]=M(t=>!s.value&&h(),["self"]))},[a("div",Ba,[a("div",Ta,[a("div",Pa,[c.value?(d(),z(o(D),{key:1,size:"24"})):(d(),z(o(j),{key:0,size:"24"}))]),a("div",Sa,[a("h2",null,v(c.value?"Update Pendidikan":"Tambah Pendidikan Baru"),1),a("p",null,v(c.value?"Ubah informasi jenjang pendidikan yang sudah ada":"Masukkan nama jenjang pendidikan baru"),1)]),a("button",{class:"close-btn",onClick:h,disabled:s.value},[i(o(O),{size:"20"})],8,Ma)]),a("form",{onSubmit:M(E,["prevent"]),class:"modal-body"},[a("div",za,[a("div",$a,[e[17]||(e[17]=a("label",{class:"form-label"},"Jenjang Pendidikan",-1)),a("div",ja,[i(o(Z),{size:"18",class:"input-icon"}),w(a("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>m.value.name=t),type:"text",required:"",placeholder:"Contoh: SD, SMP, SMA, S1, dll.",disabled:s.value},null,8,Da),[[P,m.value.name]])])])]),a("div",Aa,[a("button",{type:"button",class:"btn btn-ghost",onClick:h,disabled:s.value},"Batal",8,Ea),a("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:s.value},[s.value?(d(),u(x,{key:0},[e[18]||(e[18]=a("div",{class:"spinner small"},null,-1)),e[19]||(e[19]=a("span",null,"Menyimpan...",-1))],64)):(d(),u(x,{key:1},[i(o(W),{size:"18"}),a("span",null,v(c.value?"Update Pendidikan":"Simpan Pendidikan"),1)],64))],8,Ua)])],32)])])):Q("",!0)]),_:1})]))}},Xa=I(Va,[["__scopeId","data-v-0bf16dad"]]);export{Xa as default};
